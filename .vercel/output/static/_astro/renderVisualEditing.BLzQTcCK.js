import{ei as Xr,ej as Jr,a2 as Tt,a0 as Dt,ee as Un,G as p,ek as on,cN as xt,cO as sn,cv as Zr,cP as Qr,el as eo,cE as to,cY as no,ak as ue,b6 as ro,dB as oo,aD as io,aE as so,em as ao,aw as co,aC as uo,aB as lo,aQ as po,aF as zn,a6 as fo,t as We,a7 as Ot,$ as mo,en as Et,aL as Nt,aN as oe,aG as ce,eo as Fn,ep as yo,aO as ho,b2 as go,ea as pt,eq as vo,q as wo,er as bo,aq as xo,aM as rt,H as Eo,ab as Oe,cS as Io,es as So,aA as ko,cc as Mo,ac as ge,dn as jo,ah as Co,bx as Gn,am as qn,ag as Lt,et as _o,bE as Vt,a9 as Po,eu as $o,R as Ro,a as Ao,cL as Kn,ev as To,aJ as Do,aR as Vn,ck as Oo,ae as Me,an as No,b9 as ht,bB as Lo,d9 as Uo,cx as zo,bM as Fo,ew as Go,cg as qo,ai as Ko,bG as Vo,ex as Wo,bv as Wn,bw as Wt,bt as Bo,ey as Ho,cU as Yo,bL as Xo,d1 as Jo,cj as Zo,dI as Qo}from"./index.GAdVpEDN.js";import{r as g,g as ei}from"./index.DB4Po_jQ.js";import{c as ti}from"./client.C73kiKoU.js";import{c as q}from"./compiler-runtime.BVN8GnAY.js";import{i as Bn,a as Hn,c as ni}from"./index.DN6yRWMu.js";Xr();function Ie(t){return t.split(/[[.\]]/g).filter(Boolean).map(e=>e.includes("==")?ii(e):si(e))}const ri=/^-?\d+$/;function oi(t){return t.replace(/^['"]/,"").replace(/['"]$/,"")}function ii(t){const[e,n]=t.split("==");if(e!=="_key")throw new Error(`Currently only "_key" is supported as path segment. Found ${e}`);if(typeof n>"u")throw new Error('Invalid path segment, expected `key=="value"`');return{_key:oi(n)}}function si(t){return ri.test(t)?Number(t):t}function ai(t,e){if(e<0||e>=t.length)throw new Error("Index out of bounds");return t[e]}function ci(t,e){return t.length<=e.length&&t.every((n,r)=>ui(n,ai(e,r)))}function ui(t,e){return an(t)&&an(e)?t._key===e._key:li(t)?Number(t)===Number(e):t===e}function an(t){return typeof t?._key=="string"}function li(t){return typeof t=="number"}function gt(t){return typeof t=="object"&&"_key"in t&&typeof t._key=="string"}function Yn(t){return typeof t=="number"||gt(t)}function di(t){return typeof t=="string"}const pi=/^[a-z_$]+/;function fi(t,e){return Array.isArray(t)?`[${t[0]}:${t[1]||""}]`:typeof t=="number"?`[${t}]`:gt(t)?`[_key==${JSON.stringify(t._key)}]`:typeof t=="string"&&pi.test(t)?e?t:`.${t}`:`['${t}']`}function ne(t){return t.map((e,n)=>fi(e,n===0)).join("")}function Xn(t){return Array.isArray(t)?t:[t]}function mi(t){return"createIfNotExists"in t}function yi(t){return"createOrReplace"in t}function hi(t){return"create"in t}function gi(t){return"delete"in t}function vi(t){return"patch"in t}function wi(t){return"set"in t}function bi(t){return"setIfMissing"in t}function xi(t){return"diffMatchPatch"in t}function Ei(t){return"unset"in t}function Ii(t){return"inc"in t}function Si(t){return"inc"in t}function ki(t){return"insert"in t}function Mi(t){return t.map(Jn)}function ji(t){return Jn(t)}function Jn(t){if(mi(t))return{type:"createIfNotExists",document:t.createIfNotExists};if(yi(t))return{type:"createOrReplace",document:t.createOrReplace};if(hi(t))return{type:"create",document:t.create};if(gi(t))return{id:t.delete.id,type:"delete"};if(vi(t))return{type:"patch",id:t.patch.id,patches:_i(t.patch)};throw new Error(`Unknown mutation: ${JSON.stringify(t)}`)}const cn=["before","replace","after"];function Ci(t){const e=cn.filter(n=>n in t);if(e.length>1)throw new Error(`Insert patch is ambiguous. Should only contain one of: ${cn.join(", ")}, instead found ${e.join(", ")}`);return e[0]}function _i(t){return[...Pi(t),...$i(t),...Ai(t),...Ti(t),...Di(t),...Oi(t),...Ri(t)]}function Pi(t){return wi(t)?Object.keys(t.set).map(e=>({path:Ie(e),op:{type:"set",value:t.set[e]}})):[]}function $i(t){return bi(t)?Object.keys(t.setIfMissing).map(e=>({path:Ie(e),op:{type:"setIfMissing",value:t.setIfMissing[e]}})):[]}function Ri(t){return xi(t)?Object.keys(t.diffMatchPatch).map(e=>({path:Ie(e),op:{type:"diffMatchPatch",value:t.diffMatchPatch[e]}})):[]}function Ai(t){return Ei(t)?t.unset.map(e=>({path:Ie(e),op:{type:"unset"}})):[]}function Ti(t){return Ii(t)?Object.keys(t.inc).map(e=>({path:Ie(e),op:{type:"inc",amount:t.inc[e]}})):[]}function Di(t){return Si(t)?Object.keys(t.dec).map(e=>({path:Ie(e),op:{type:"dec",amount:t.dec[e]}})):[]}function Oi(t){if(!ki(t))return[];const e=Ci(t.insert);if(!e)throw new Error("Insert patch missing position");const n=Ie(t.insert[e]),r=n.pop(),o=e==="replace"?{type:"insert",position:e,referenceItem:r,items:t.insert.items}:{type:"insert",position:e,referenceItem:r,items:t.insert.items};return[{path:n,op:o}]}function Zn(t){return tr(t)}function Qn(t){return t.flatMap(Zn)}function er(t){return{transactionId:t.id,mutations:Qn(t.mutations)}}function tr(t){switch(t.type){case"create":return{[t.type]:t.document};case"createIfNotExists":return{[t.type]:t.document};case"createOrReplace":return{[t.type]:t.document};case"delete":return{delete:{id:t.id}};case"patch":{const e=t.options?.ifRevision;return t.patches.map(n=>({patch:{id:t.id,...e&&{ifRevisionID:e},...nr(n)}}))}}}function nr(t){const{path:e,op:n}=t;if(n.type==="unset")return{unset:[ne(e)]};if(n.type==="insert")return{insert:{[n.position]:ne([...e,n.referenceItem]),items:n.items}};if(n.type==="diffMatchPatch")return{diffMatchPatch:{[ne(e)]:n.value}};if(n.type==="inc")return{inc:{[ne(e)]:n.amount}};if(n.type==="dec")return{dec:{[ne(e)]:n.amount}};if(n.type==="set"||n.type==="setIfMissing")return{[n.type]:{[ne(e)]:n.value}};if(n.type==="truncate"){const r=[n.startIndex,typeof n.endIndex=="number"?n.endIndex:""].join(":");return{unset:[`${ne(e)}[${r}]`]}}if(n.type==="upsert")return{unset:n.items.map(r=>ne([...e,{_key:r._key}])),insert:{[n.position]:ne([...e,n.referenceItem]),items:n.items}};if(n.type==="assign")return{set:Object.fromEntries(Object.keys(n.value).map(r=>[ne(e.concat(r)),n.value[r]]))};if(n.type==="unassign")return{unset:n.keys.map(r=>ne(e.concat(r)))};if(n.type==="replace")return{insert:{replace:ne(e.concat(n.referenceItem)),items:n.items}};if(n.type==="remove")return{unset:[ne(e.concat(n.referenceItem))]};throw n.type==="insertIfMissing"?new Error("Patch type insertIfMissing is not supported by Sanity"):new Error(`Unknown operation type ${n.type}`)}function Bt(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function Ni(t,e,n){return{type:"patch",id:t,patches:Xn(e)}}function ve(t,e){return{path:typeof t=="string"?Ie(t):t,op:e}}function Li(t){return{type:"createIfNotExists",document:t}}function Ye(t,e,n){return{type:"insert",referenceItem:n,position:e,items:Xn(t)}}function rr(t,e){return{type:"truncate",startIndex:t,endIndex:e}}function un(t){return{type:"remove",referenceItem:t}}var Ui=Object.freeze({__proto__:null,decode:ji,decodeAll:Mi,encode:Zn,encodeAll:Qn,encodeMutation:tr,encodePatch:nr,encodeTransaction:er});const Ht=Jr();let or=Ht;const Ut=new Set;function ir(t){return t===Ht}function zi(t){or=t;for(const e of Ut)e()}const Fi=/_key\s*==\s*['"](.*)['"]/,Gi=/^\d*:\d*$/;function sr(t){return typeof t=="number"||typeof t=="string"&&/^\[\d+\]$/.test(t)}function ar(t){return typeof t=="string"?Fi.test(t.trim()):typeof t=="object"&&"_key"in t}function qi(t){if(typeof t=="string"&&Gi.test(t))return!0;if(!Array.isArray(t)||t.length!==2)return!1;const[e,n]=t;return(typeof e=="number"||e==="")&&(typeof n=="number"||n==="")}const Ki=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Vi=/_key\s*==\s*['"](.*)['"]/;function Le(t,e,n){const r=typeof e=="string"?Wi(e):e;if(!Array.isArray(r))throw new Error("Path must be an array or a string");let o=t;for(let i=0;i<r.length;i++){const s=r[i];if(sr(s)){if(!Array.isArray(o))return n;o=o[s]}if(ar(s)){if(!Array.isArray(o))return n;o=o.find(c=>c._key===s._key)}if(typeof s=="string"&&(o=typeof o=="object"&&o!==null?o[s]:void 0),typeof o>"u")return n}return o}function Wi(t){if(typeof t!="string")throw new Error("Path is not a string");const e=t.match(Ki);if(!e)throw new Error("Invalid path string");return e.map(Bi)}function Bi(t){return sr(t)?Hi(t):ar(t)?Yi(t):qi(t)?Xi(t):t}function Hi(t){return Number(t.replace(/[^\d]/g,""))}function Yi(t){return{_key:t.match(Vi)[1]}}function Xi(t){const[e,n]=t.split(":").map(r=>r===""?r:Number(r));return[e,n]}function Yt(){return g.useSyncExternalStore(Qi,Zi,Ji)}function Ji(){return Ht}function Zi(){return or}function Qi(t){return Ut.add(t),()=>Ut.delete(t)}function cr(){const t=q.c(2),e=Yt();let n;return t[0]!==e?(n=ir(e),t[0]=e,t[1]=n):n=t[1],!n}function ur(t,e){let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>{t.apply(t,r)},e)}}function Qe(t,e){const n=Bn(),r=Hn();if(ir(e)||!n&&!r)throw new Error("The `useDocuments` hook cannot be used in this context");const o=Tt(t),i=Dt(t),s=e.getSnapshot().context?.documents,c=s?.[o],a=s?.[i],u=c||a;if(!u)throw new Error(`Document "${t}" not found`);const l=c.getSnapshot().context?.local||a.getSnapshot().context?.local,f=new Promise(d=>{if(l)d(l);else{const y=u.on("ready",v=>{const{snapshot:m}=v;d(m||null),y.unsubscribe()})}});return{draftDoc:c,draftId:o,getSnapshot:()=>f,publishedDoc:a,publishedId:i,get snapshot(){if(!l)throw new Error(`Snapshot for document "${t}" not found`);return l}}}function es(t,e){return()=>{const{draftDoc:n}=Qe(t,e);n.send({type:"submit"})}}function ts(t,e){return n=>{const{snapshot:r}=Qe(t,e);return n?Le(r,n):r}}function ns(t,e){const{getSnapshot:n}=Qe(t,e);return n}function rs(t,e){return async(n,r)=>{const o=Qe(t,e),{draftDoc:i,draftId:s,getSnapshot:c,publishedId:a}=o,{commit:u=!0}=r||{},l=await(typeof n=="function"?n({draftId:s,publishedId:a,get snapshot(){return o.snapshot},getSnapshot:c}):n),f=await c();if(!f)throw new Error(`Snapshot for document "${t}" not found`);i.send({type:"mutate",mutations:[Li({...f,_id:s}),Ni(s,l)]}),u&&(typeof u=="object"&&"debounce"in u?ur(()=>i.send({type:"submit"}),u.debounce)():i.send({type:"submit"}))}}function lr(){const t=q.c(7),e=Yt();let n;t[0]!==e?(n=c=>({id:c,commit:es(c,e),get:ts(c,e),getSnapshot:ns(c,e),patch:rs(c,e)}),t[0]=e,t[1]=n):n=t[1];const r=n;let o;t[2]!==e?(o=(c,a,u)=>{const{draftDoc:l}=Qe(c,e),{commit:f}=u||{},d=f===void 0?!0:f;l.send({type:"mutate",mutations:a}),d&&(typeof d=="object"&&"debounce"in d?ur(()=>l.send({type:"submit"}),d.debounce)():l.send({type:"submit"}))},t[2]=e,t[3]=o):o=t[3];const i=o;let s;return t[4]!==r||t[5]!==i?(s={getDocument:r,mutateDocument:i},t[4]=r,t[5]=i,t[6]=s):s=t[6],s}function os(t=16){const e=new Uint8Array(t);return crypto.getRandomValues(e),e}const is=(()=>{let t;return()=>{if(t)return t;t=[];for(let e=0;e<256;++e)t[e]=(e+256).toString(16).slice(1);return t}})();function dr(t){const e=is();return os(t).reduce((n,r)=>n+e[r],"").slice(0,t)}function Ue(t){const e=typeof t=="string"?t:t.path,n=e.lastIndexOf("."),r=e.substring(n+1,e.length);if(!r.indexOf("["))throw new Error("Invalid path: not an array");const o=e.lastIndexOf("["),i=e.substring(0,o);let s,c;if(r.includes("_key")){const a=r.indexOf('"')+1,u=r.indexOf('"',a);s=r.substring(a,u),c=!0}else{const a=r.indexOf("[")+1,u=r.indexOf("]",a);s=r.substring(a,u),c=!1}if(!i||!s)throw new Error("Invalid path");return{path:i,key:s,hasExplicitKey:c}}function ss(t,e,n="after"){const{path:r,key:o}=Ue(t),i={...Le(e,t.path),_key:dr()};return[ve(r,Ye(i,n,{_key:o}))]}function as(t,e){const{path:n,key:r}=Ue(t),o=Le(e,n).findIndex(i=>i._key===r);return[ve(n,rr(o,o+1))]}function cs(t,e,n){const{path:r,key:o}=Ue(t),i=dr();return[ve(r,Ye([{_type:e,_key:i}],n,{_key:o}))]}async function ot(t,e,n){if(!t.type)throw new Error("Node type is missing");const{path:r,key:o}=Ue(t),i=await e.getSnapshot(),s=Le(i,r),c=Le(i,t.path),a=s.findIndex(f=>f._key===o);let u=-1,l="before";if(n==="first"){if(a===0)return[];u=0,l="before"}else if(n==="last"){if(a===s.length-1)return[];u=-1,l="after"}else if(n==="next"){if(a===s.length-1)return[];u=a,l="after"}else if(n==="previous"){if(a===0)return[];u=a-1,l="before"}return[ve(r,rr(a,a+1)),ve(r,Ye(c,l,u))]}let It;function Xt(t){return{lang:t?.lang??It?.lang,message:t?.message,abortEarly:t?.abortEarly??It?.abortEarly,abortPipeEarly:t?.abortPipeEarly??It?.abortPipeEarly}}let us;function ls(t){return us?.get(t)}let ds;function ps(t){return ds?.get(t)}let fs;function ms(t,e){return fs?.get(t)?.get(e)}function ys(t){const e=typeof t;return e==="string"?`"${t}"`:e==="number"||e==="bigint"||e==="boolean"?`${t}`:e==="object"||e==="function"?(t&&Object.getPrototypeOf(t)?.constructor?.name)??"null":e}function Xe(t,e,n,r,o){const i=o&&"input"in o?o.input:n.value,s=o?.expected??t.expects??null,c=o?.received??ys(i),a={kind:t.kind,type:t.type,input:i,expected:s,received:c,message:`Invalid ${e}: ${s?`Expected ${s} but r`:"R"}eceived ${c}`,requirement:t.requirement,path:o?.path,issues:o?.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},u=t.kind==="schema",l=o?.message??t.message??ms(t.reference,a.lang)??(u?ps(a.lang):null)??r.message??ls(a.lang);l!==void 0&&(a.message=typeof l=="function"?l(a):l),u&&(n.typed=!1),n.issues?n.issues.push(a):n.issues=[a]}function je(t){return{version:1,vendor:"valibot",validate(e){return t["~run"]({value:e},Xt())}}}function hs(t,e){return Object.hasOwn(t,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}var gs=class extends Error{constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function Jt(t,e){return{kind:"validation",type:"min_length",reference:Jt,async:!1,expects:`>=${t}`,requirement:t,message:e,"~run"(n,r){return n.typed&&n.value.length<this.requirement&&Xe(this,"length",n,r,{received:`${n.value.length}`}),n}}}function pr(t,e,n){return typeof t.fallback=="function"?t.fallback(e,n):t.fallback}function vs(t,e){return{...t,fallback:e,get"~standard"(){return je(this)},"~run"(n,r){const o=t["~run"](n,r);return o.issues?{typed:!0,value:pr(this,o,r)}:o}}}function fr(t,e,n){return typeof t.default=="function"?t.default(e,n):t.default}function ws(t,e){return!t["~run"]({value:e},{abortEarly:!0}).issues}function Zt(t,e){return{kind:"schema",type:"object",reference:Zt,expects:"Object",async:!1,entries:t,message:e,get"~standard"(){return je(this)},"~run"(n,r){const o=n.value;if(o&&typeof o=="object"){n.typed=!0,n.value={};for(const i in this.entries){const s=this.entries[i];if(i in o||(s.type==="exact_optional"||s.type==="optional"||s.type==="nullish")&&s.default!==void 0){const c=i in o?o[i]:fr(s),a=s["~run"]({value:c},r);if(a.issues){const u={type:"object",origin:"value",input:o,key:i,value:c};for(const l of a.issues)l.path?l.path.unshift(u):l.path=[u],n.issues?.push(l);if(n.issues||(n.issues=a.issues),r.abortEarly){n.typed=!1;break}}a.typed||(n.typed=!1),n.value[i]=a.value}else if(s.fallback!==void 0)n.value[i]=pr(s);else if(s.type!=="exact_optional"&&s.type!=="optional"&&s.type!=="nullish"&&(Xe(this,"key",n,r,{input:void 0,expected:`"${i}"`,path:[{type:"object",origin:"key",input:o,key:i,value:o[i]}]}),r.abortEarly))break}}else Xe(this,"type",n,r);return n}}}function Qt(t,e){return{kind:"schema",type:"optional",reference:Qt,expects:`(${t.expects} | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return je(this)},"~run"(n,r){return n.value===void 0&&(this.default!==void 0&&(n.value=fr(this,n,r)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function mr(t,e,n){return{kind:"schema",type:"record",reference:mr,expects:"Object",async:!1,key:t,value:e,message:n,get"~standard"(){return je(this)},"~run"(r,o){const i=r.value;if(i&&typeof i=="object"){r.typed=!0,r.value={};for(const s in i)if(hs(i,s)){const c=i[s],a=this.key["~run"]({value:s},o);if(a.issues){const l={type:"object",origin:"key",input:i,key:s,value:c};for(const f of a.issues)f.path=[l],r.issues?.push(f);if(r.issues||(r.issues=a.issues),o.abortEarly){r.typed=!1;break}}const u=this.value["~run"]({value:c},o);if(u.issues){const l={type:"object",origin:"value",input:i,key:s,value:c};for(const f of u.issues)f.path?f.path.unshift(l):f.path=[l],r.issues?.push(f);if(r.issues||(r.issues=u.issues),o.abortEarly){r.typed=!1;break}}(!a.typed||!u.typed)&&(r.typed=!1),a.typed&&(r.value[a.value]=u.value)}}else Xe(this,"type",r,o);return r}}}function et(t){return{kind:"schema",type:"string",reference:et,expects:"string",async:!1,message:t,get"~standard"(){return je(this)},"~run"(e,n){return typeof e.value=="string"?e.typed=!0:Xe(this,"type",e,n),e}}}function yr(){return{kind:"schema",type:"unknown",reference:yr,expects:"unknown",async:!1,get"~standard"(){return je(this)},"~run"(t){return t.typed=!0,t}}}function bs(t,e,n){const r=t["~run"]({value:e},Xt(n));if(r.issues)throw new gs(r.issues);return r.value}function hr(...t){return{...t[0],pipe:t,get"~standard"(){return je(this)},"~run"(e,n){for(const r of t)if(r.kind!=="metadata"){if(e.issues&&(r.kind==="schema"||r.kind==="transformation")){e.typed=!1;break}(!e.issues||!n.abortEarly&&!n.abortPipeEarly)&&(e=r["~run"](e,n))}return e}}}function ln(t,e,n){const r=t["~run"]({value:e},Xt(n));return{typed:r.typed,success:!r.issues,output:r.value,issues:r.issues}}const lt=hr(et(),Jt(1)),Ve=Qt(lt),zt=Zt({baseUrl:lt,dataset:Ve,id:lt,path:lt,projectId:Ve,tool:Ve,type:Ve,workspace:Ve,perspective:vs(et(),"drafts")});function xs(t){return ws(zt,t)}function Es(t){return t!==null&&Array.isArray(t)}function Is(t){let e="";for(const n of t){if(typeof n=="string"){e&&(e+="."),e+=n;continue}if(typeof n=="number"){e&&(e+=":"),e+=`${n}`;continue}if(Es(n)){e&&(e+=":"),e+=`${n.join(",")}}`;continue}if(n._key){e&&(e+=":"),e+=`${n._key}`;continue}}return e}const Ss=/^([\w-]+):(0|[1-9][0-9]*)$/,ks=/^([\w-]+):([0-9]+),([0-9]+)$/,Ms=/^([\w-]+):([\w-]+)$/;function js(t){const e=[];for(const n of t.split(".")){const r=Ss.exec(n);if(r){e.push(r[1],Number(r[2]));continue}const o=ks.exec(n);if(o){e.push(o[1],[Number(o[2]),Number(o[3])]);continue}const i=Ms.exec(n);if(i){e.push(i[1],{_key:i[2]});continue}e.push(n)}return e}const dn=hr(et(),Jt(1)),Cs=Zt({origin:dn,href:dn,data:Qt(mr(et(),yr()))});function _s(t){const e=t.split(";").reduce((n,r)=>{const[o,i]=r.split("=");if(!o||r.includes("=")&&!i)return n;switch(o){case"id":n.id=i;break;case"type":n.type=i;break;case"path":n.path=Un.toString(js(i));break;case"base":n.baseUrl=decodeURIComponent(i);break;case"perspective":n.perspective=i;break;case"tool":n.tool=i;break;case"workspace":n.workspace=i;break;case"projectId":n.projectId=i;break;case"dataset":n.dataset=i;break}return n},{});if(xs(e))return e}function pn(t){const e=ln(zt,t);if(e.success)return e.output;const n=ln(Cs,t);if(n.success)try{const r=new URL(n.output.href,typeof document>"u"?"https://example.com":location.origin);return r.searchParams.size>0?bs(zt,Object.fromEntries(r.searchParams.entries())):n.output}catch(r){return console.error("Failed to parse sanity node",r),n.output}}function Ps(t){if(typeof t=="object"&&t!==null)return pn(t);try{const e=JSON.parse(t);return pn(e)}catch{return _s(t)}}var gr={0:8203,1:8204,2:8205,3:8290,4:8291,5:8288,6:65279,7:8289,8:119155,9:119156,a:119157,b:119158,c:119159,d:119160,e:119161,f:119162},Be={0:8203,1:8204,2:8205,3:65279},$s={0:String.fromCodePoint(Be[0]),1:String.fromCodePoint(Be[1]),2:String.fromCodePoint(Be[2]),3:String.fromCodePoint(Be[3])},Rs=new Array(4).fill(String.fromCodePoint(Be[0])).join(""),fn="\0",it=Object.fromEntries(Object.entries($s).map(t=>[t[1],+t[0]])),mn=Object.fromEntries(Object.entries(gr).map(t=>t.reverse())),As=`${Object.values(gr).map(t=>`\\u{${t.toString(16)}}`).join("")}`,Ft=new RegExp(`[${As}]{4,}`,"gu");function Ts(t){let e=t.match(Ft);if(e)return Ds(e[0],!0)[0]}function Ds(t,e=!1){let n=Array.from(t);if(n.length%2===0){if(n.length%4||!t.startsWith(Rs))return Os(n,e)}else throw new Error("Encoded data has invalid length");let r=n.slice(4),o=new Uint8Array(r.length/4);for(let s=0;s<o.length;s++)o[s]=it[r[s*4]]<<6|it[r[s*4+1]]<<4|it[r[s*4+2]]<<2|it[r[s*4+3]];let i=new TextDecoder().decode(o);if(e){let s=i.indexOf(fn);return s===-1&&(s=i.length),[JSON.parse(i.slice(0,s))]}return i.split(fn).filter(Boolean).map(s=>JSON.parse(s))}function Os(t,e){var n;let r=[];for(let c=t.length*.5;c--;){let a=`${mn[t[c*2].codePointAt(0)]}${mn[t[c*2+1].codePointAt(0)]}`;r.unshift(String.fromCharCode(parseInt(a,16)))}let o=[],i=[r.join("")],s=10;for(;i.length;){let c=i.shift();try{if(o.push(JSON.parse(c)),e)return o}catch(a){if(!s--)throw a;let u=+((n=a.message.match(/\sposition\s(\d+)$/))==null?void 0:n[1]);if(!u)throw a;i.unshift(c.substring(0,u),c.substring(u))}}return o}const te=[];for(let t=0;t<256;++t)te.push((t+256).toString(16).slice(1));function Ns(t,e=0){return(te[t[e+0]]+te[t[e+1]]+te[t[e+2]]+te[t[e+3]]+"-"+te[t[e+4]]+te[t[e+5]]+"-"+te[t[e+6]]+te[t[e+7]]+"-"+te[t[e+8]]+te[t[e+9]]+"-"+te[t[e+10]]+te[t[e+11]]+te[t[e+12]]+te[t[e+13]]+te[t[e+14]]+te[t[e+15]]).toLowerCase()}let St;const Ls=new Uint8Array(16);function Us(){if(!St){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");St=crypto.getRandomValues.bind(crypto)}return St(Ls)}const zs=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var yn={randomUUID:zs};function vr(t,e,n){if(yn.randomUUID&&!t)return yn.randomUUID();t=t||{};const r=t.random??t.rng?.()??Us();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Ns(r)}function me(t){const e=t.getBoundingClientRect();return{x:e.x+scrollX,y:e.y+scrollY,w:e.width,h:e.height}}function hn(t,e,n){return n==="x"?{x:t.x+e,y:t.y,w:t.w-2*e,h:t.h}:{x:t.x,y:t.y+e,w:t.w,h:t.h-2*e}}function Fs(t,e){const{x1:n,y1:r,x2:o,y2:i}=t,{x1:s,y1:c,x2:a,y2:u}=e;if(n===o&&r===i||s===a&&c===u)return!1;const l=(u-c)*(o-n)-(a-s)*(i-r);if(l===0)return!1;const f=((a-s)*(r-c)-(u-c)*(n-s))/l,d=((o-n)*(r-c)-(i-r)*(n-s))/l;if(f<0||f>1||d<0||d>1)return!1;const y=n+f*(o-n),v=r+f*(i-r);return{x:y,y:v}}function wr(t,e){return t.x===e.x&&t.y===e.y&&t.w===e.w&&t.h===e.h}function Gs(t,e){const n=[{x1:e.x,y1:e.y,x2:e.x+e.w,y2:e.y},{x1:e.x+e.w,y1:e.y,x2:e.x+e.w,y2:e.y+e.h},{x1:e.x+e.w,y1:e.y+e.h,x2:e.x,y2:e.y+e.h},{x1:e.x,y1:e.y+e.h,x2:e.x,y2:e.y}],r=[];for(let o=0;o<n.length;o++){const i=Fs(t,n[o]);if(i){let s=!1;for(let c=0;c<r.length;c++)r[c].x===i.x&&r[c].y===i.y&&(s=!0);s||r.push(i)}}return r.length===0?!1:r.sort((o,i)=>Je(o,{x:t.x1,y:t.y1})-Je(i,{x:t.x1,y:t.y1}))}function Je(t,e){const n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}function qs(t,e){const n=t.x>=e.x&&t.x<=e.x+e.w,r=t.y>=e.y&&t.y<=e.y+e.h;return n&&r}function st(t,e,n){const r={x:t.x1,y:t.y1};if(e.some(s=>qs(r,hn(s,Math.min(s.w,s.h)/10,n==="horizontal"?"x":"y"))))return null;let o,i;for(const s of e){const c=Gs(t,hn(s,Math.min(s.w,s.h)/10,n==="horizontal"?"x":"y"));if(c){const a=c[0];o?Je(r,a)<Je(r,o)&&(o=a,i=s):(o=a,i=s)}}return i||null}function br(t,e,n){const{x:r,y:o,w:i,h:s}=t,{x:c,y:a}=n,u=c+(r-c)*e,l=a+(o-a)*e,f=i*e,d=s*e;return{x:u,y:l,w:f,h:d}}function Ks(t){const e=Math.max(0,Math.min(...t.map(r=>r.x))),n=Math.min(document.body.offsetWidth,Math.max(...t.map(r=>r.x+r.w)));return{min:e,max:n,width:n-e}}function Gt(t){const e=Math.max(0,Math.min(...t.map(r=>r.y))),n=Math.min(document.body.scrollHeight,Math.max(...t.map(r=>r.y+r.h)));return{min:e,max:n,height:n-e}}function Vs(t){return t.some(e=>t.filter(n=>!wr(e,n)).some(n=>e.y===n.y))?"horizontal":"vertical"}function Ws(t,e,n){if(n==="horizontal"){const r={x1:t.x,y1:t.y,x2:t.x-1e8,y2:t.y},o={x1:t.x,y1:t.y,x2:t.x+1e8,y2:t.y};return{left:st(r,e,n),right:st(o,e,n)}}else{const r={x1:t.x,y1:t.y,x2:t.x,y2:t.y-1e8},o={x1:t.x,y1:t.y,x2:t.x,y2:t.y+1e8};return{top:st(r,e,n),bottom:st(o,e,n)}}}function at(t,e){return e.find(n=>wr(me(n.elements.element),t))?.sanity}function gn(t,e,n){return Object.values(e).every(r=>r===null)?null:n==="horizontal"?{left:e.left?{rect:e.left,sanity:at(e.left,t)}:null,right:e.right?{rect:e.right,sanity:at(e.right,t)}:null}:{top:e.top?{rect:e.top,sanity:at(e.top,t)}:null,bottom:e.bottom?{rect:e.bottom,sanity:at(e.bottom,t)}:null}}function vn(t){const e=document.body.getBoundingClientRect();return{x:Math.max(e.x,Math.min(t.clientX,e.x+e.width)),y:t.clientY+window.scrollY}}function Bs(t){const e=document.body,n=window.getComputedStyle(e).transform;if(n==="none")return{x:t.x,y:t.y};const r=new DOMMatrix(n).inverse(),o=new DOMPoint(t.x,t.y).matrixTransform(r);return{x:o.x,y:o.y}}function kt(t,e,n){const r=me(e),o=[...e.querySelectorAll(":where(h1, h2, h3, h4, p, a, img, span, button):not(:has(*))")];t.x<=r.x&&(t.x=r.x),t.x>=r.x+r.w&&(t.x=r.x+r.w),t.y>=r.y+r.h&&(t.y=r.y+r.h),t.y<=r.y&&(t.y=r.y);const i=o.map(s=>{const c=br(me(s),n,{x:r.x,y:r.y});return{x:c.x-r.x,y:c.y-r.y,w:c.w,h:c.h,tagName:s.tagName}});return{offsetX:(r.x-t.x)*n,offsetY:(r.y-t.y)*n,w:r.w*n,h:r.h*n,maxWidth:r.w*n*.75,childRects:i}}const Hs=4;async function Ys(t,e,n,r,o){return new Promise(i=>{t.addEventListener("transitionend",()=>{setTimeout(()=>{r({type:"overlay/dragEndMinimapTransition"})},o*2),i()},{once:!0}),r({type:"overlay/dragStartMinimapTransition"}),r({type:"overlay/dragToggleMinimap",display:!0}),document.body.style.overflow="hidden",document.body.style.height="100%",document.documentElement.style.overflow="initial",document.documentElement.style.height="100%",setTimeout(()=>{t.style.transformOrigin="50% 0px",t.style.transition="transform 150ms ease",t.style.transform=`translate3d(0px, ${-n+scrollY}px, 0px) scale(${e})`},25)})}function Xs(t,e){let n=e||Gt(t).height;const r=100;n+=r*2;const o=n>window.innerHeight?window.innerHeight/n:1,i=t.map(c=>br(c,o,{x:window.innerWidth/2,y:0})),{min:s}=Gt(i);return{scaleFactor:o,minYScaled:s-r*o}}function wn(t){const e=Ks(t),n=Gt(t),r=8,o=e.min>r&&e.min+e.width<=window.innerWidth-r,i=n.min>r&&n.min+n.height<=document.body.scrollHeight-r,s=o&&i;return{x:s?e.min-r:e.min,y:s?n.min-r:n.min,w:s?e.width+r*2:e.width,h:s?n.height+r*2:n.height}}async function bn(t,e,n,r,o,i){return new Promise(s=>{const c=window.getComputedStyle(e).transform;if(new DOMMatrix(c).a===1)return;const a=n-window.innerHeight,u=scrollY;t-=window.innerHeight/2,t<0&&(t=0),e.addEventListener("transitionend",()=>{e.style.transition="none",e.style.transform="none",scrollTo({top:t,behavior:"instant"}),setTimeout(()=>{r({type:"overlay/dragEndMinimapTransition"}),r({type:"overlay/dragToggleMinimap",display:!1})},o*2),s()},{once:!0}),r({type:"overlay/dragStartMinimapTransition"}),e.style.transform=`translateY(${Math.max(u-t,-a+u)}px) scale(1)`,i&&(document.body.style.overflow=i.body.overflow,document.body.style.height=i.body.height,document.documentElement.style.overflow=i.documentElement.overflow,document.documentElement.style.height=i.documentElement.height)})}let pe=!1,Mt={y:0},he={x:0,y:0},jt=typeof document>"u"?0:document.documentElement.scrollHeight,Ct=null;function Js(t){const{mouseEvent:e,element:n,overlayGroup:r,handler:o,target:i,onSequenceStart:s,onSequenceEnd:c}=t;if(e.button!==0)return;window.focus();const a=150;let u=r.map(L=>me(L.elements.element));const l=n.getAttribute("data-sanity-drag-flow")||Vs(u),f=n.getAttribute("data-sanity-drag-group"),d=!!n.getAttribute("data-sanity-drag-minimap-disable"),y=!!n.getAttribute("data-sanity-drag-prevent-default"),v=n.getAttribute("data-unstable_sanity-drag-document-height"),m=n.getAttribute("data-unstable_sanity-drag-group-height");let E=null;const M=vn(e),S=document.body,{minYScaled:$,scaleFactor:k}=Xs(u,m?~~m:null);let R=!1,A=!1,U=!0;pe||(Ct={body:{overflow:window.getComputedStyle(document.body).overflow,height:window.getComputedStyle(document.body).height},documentElement:{overflow:window.getComputedStyle(document.documentElement).overflow,height:window.getComputedStyle(document.documentElement).height}},jt=v?~~v:document.documentElement.scrollHeight);const C=setInterval(()=>{u=r.map(L=>me(L.elements.element))},a),N=()=>{if(k>=1)return;const L=kt(he,n,k);o({type:"overlay/dragUpdateSkeleton",skeleton:L}),o({type:"overlay/dragToggleMinimapPrompt",display:!1}),Ys(S,k,$,o,a).then(()=>{setTimeout(()=>{o({type:"overlay/dragUpdateGroupRect",groupRect:wn(u)})},a*2)})},_=L=>{Math.abs(L.deltaY)>=10&&k<1&&!pe&&!A&&!d&&U&&(o({type:"overlay/dragToggleMinimapPrompt",display:!0}),A=!0),L.shiftKey&&!pe&&!d&&(window.dispatchEvent(new CustomEvent("unstable_sanity/dragApplyMinimap")),pe=!0,setTimeout(()=>{N()},50))},j=L=>{if(L.preventDefault(),he=vn(L),Mt=Bs(he),Math.abs(Je(he,M))<Hs)return;if(!R){const V=wn(u),H=kt(he,n,1);o({type:"overlay/dragStart",flow:l}),o({type:"overlay/dragUpdateSkeleton",skeleton:H}),o({type:"overlay/dragUpdateGroupRect",groupRect:V}),R=!0,s()}o({type:"overlay/dragUpdateCursorPosition",x:he.x,y:he.y}),L.shiftKey&&!pe&&!d&&(window.dispatchEvent(new CustomEvent("unstable_sanity/dragApplyMinimap")),pe=!0,setTimeout(()=>{N()},50));const G=Ws(he,u,l);JSON.stringify(E)!==JSON.stringify(G)&&(E=G,o({type:"overlay/dragUpdateInsertPosition",insertPosition:gn(r,E,l)}))},P=()=>{U=!1,o({type:"overlay/dragEnd",target:i,insertPosition:E?gn(r,E,l):null,dragGroup:f,flow:l,preventInsertDefault:y}),A&&o({type:"overlay/dragToggleMinimapPrompt",display:!1}),pe||(clearInterval(C),c(),K(),D()),w()},I=L=>{if(L.key==="Shift"&&pe){pe=!1;const G=kt(he,n,1/k);o({type:"overlay/dragUpdateSkeleton",skeleton:G}),window.dispatchEvent(new CustomEvent("unstable_sanity/dragResetMinimap")),setTimeout(()=>{bn(Mt.y,S,jt,o,a,Ct)},50),o({type:"overlay/dragUpdateGroupRect",groupRect:null}),U||(clearInterval(C),w(),K(),D(),c())}},z=()=>{o({type:"overlay/dragUpdateGroupRect",groupRect:null}),window.dispatchEvent(new CustomEvent("unstable_sanity/dragResetMinimap")),setTimeout(()=>{bn(Mt.y,S,jt,o,a,Ct).then(()=>{pe=!1})},50),clearInterval(C),w(),K(),D(),c()},w=()=>{window.removeEventListener("mousemove",j),window.removeEventListener("wheel",_),window.removeEventListener("mouseup",P)},D=()=>{window.removeEventListener("keyup",I)},K=()=>{window.removeEventListener("blur",z)};window.addEventListener("blur",z),window.addEventListener("keyup",I),window.addEventListener("wheel",_),window.addEventListener("mousemove",j),window.addEventListener("mouseup",P)}const Ee=t=>t instanceof HTMLElement||t instanceof SVGElement;function xr(t){const{display:e}=window.getComputedStyle(t);if(e!=="inline")return t;const n=t.parentElement;return n?xr(n):null}const dt=t=>!t||!Ee(t)?null:t.dataset?.sanityOverlayElement?t:dt(t.parentElement);function qt(t){return Ft.lastIndex=0,Ft.test(t)}function Zs(t,e=!1){try{const n=Ts(t);return!n||n.origin!=="sanity.io"?null:(e&&(n.href=n.href?.replace(".alt","")),n)}catch(n){return console.error("Failed to decode stega for string: ",t,"with the original error: ",n),null}}function ct(t,e=!1){return qt(t)?Zs(t,e):null}const ut=t=>t.nodeType===Node.ELEMENT_NODE,xn=t=>t.tagName==="IMG",Qs=t=>t.tagName==="TIME",ea=t=>t.tagName.toUpperCase()==="SVG";function ke(t){return"path"in t}function ta(t,e){let n=t.split("."),r=e.split(".");const o=Math.min(n.length,r.length);return n=n.slice(0,o).reverse(),r=r.slice(0,o).reverse(),n.reduce((i,s,c)=>s===r[c]?[...i,s]:[],[]).reverse().join(".")}function En(t){if(!t.length||!t.map(o=>ke(o)).every((o,i,s)=>o===s[0]))return;if(!ke(t[0]))return t[0];const e=t.filter(ke);let n=t[0];const r=["projectId","dataset","id","baseUrl","workspace","tool"];for(let o=1;o<e.length;o++){const i=e[o];if(r.some(s=>i[s]!==n?.[s])){n=void 0;break}n={...n,path:ta(n.path,i.path)}}return n}function Er(t){const e=[];function n(i,s,c,a){const u=Ps(s);if(!u)return;const l=xr(i);if(l)return{elements:{element:i,measureElement:l},sanity:u,reason:c,preventGrouping:a}}function r(i){const{nodeType:s,parentElement:c,textContent:a}=i;if(ut(i)&&i.dataset?.sanityEditTarget!==void 0){const u=Er(i),l=En(u.map(f=>f.type==="element"?f.commonSanity:void 0).filter(f=>f!==void 0));if(l)return{reason:"edit-target",elements:{element:i,measureElement:i},sanity:l}}else if(s===Node.TEXT_NODE&&c&&a){const u=ct(a);return u?n(c,u,"stega-text",!0):void 0}else if(ut(i)){if(i.tagName==="SCRIPT"||i.tagName==="SANITY-VISUAL-EDITING")return;if(i.dataset?.sanity)return n(i,i.dataset.sanity,"data-attribute",!!(i.textContent&&qt(i.textContent)));if(i.dataset?.sanityEditInfo)return n(i,i.dataset.sanityEditInfo,"data-attribute",!!(i.textContent&&qt(i.textContent)));if(xn(i)){const u=ct(i.alt,!0);return u?n(i,u,"stega-attribute"):void 0}else if(Qs(i)){const u=ct(i.dateTime,!0);return u?n(i,u,"stega-attribute"):void 0}else if(ea(i)){if(!i.ariaLabel)return;const u=ct(i.ariaLabel,!0);return u?n(i,u,"stega-attribute"):void 0}}}function o(i,s){const c=r(i);let a=s;if(ut(i)&&i.dataset?.sanityEditGroup!==void 0&&(a={type:"group",elements:{element:i,measureElement:i},targets:[]},e.push(a)),c){const u={elements:c.elements,sanity:c.sanity,reason:c.reason};a&&!c.preventGrouping?a.targets.push(u):e.push({elements:c.elements,type:"element",targets:[u]})}if(ut(i)&&!xn(i)&&!(i.tagName==="SCRIPT"||i.tagName==="SANITY-VISUAL-EDITING"))for(const u of i.childNodes)o(u,a)}if(t)for(const i of t.childNodes)o(i,void 0);return e.map(i=>{if(i.targets.length===0&&i.type==="group")return{...i,commonSanity:void 0};const s=i.targets.length===1?i.targets[0].sanity:En(i.targets.map(({sanity:c})=>c).filter(c=>c!==void 0))||i.targets[0].sanity;return s?{...i,commonSanity:s}:null}).filter(i=>i!==null)}function Ze(t){const e=t.lastIndexOf(".");return t.substring(e,t.length).includes("[")}function In(t){if(!Ze(t))return null;const e=t.split(".");return e[e.length-1]=e[e.length-1].replace(/\[.*?\]/g,"[]"),e.join(".")}function Ir(t,e){return!Ze(t.path)||!Ze(e.path)?!1:In(t.path)===In(e.path)}function Sn(t,e,n,r){if(!t.getAttribute("data-sanity")||t.getAttribute("data-sanity-drag-disable")||!e||!ke(e)||!Ze(e.path))return null;const o=t.getAttribute("data-sanity-drag-group"),i=[...n].reduce((s,c)=>{const a=r.get(c),u=c.getAttribute("data-sanity-drag-disable"),l=c.getAttribute("data-sanity-drag-group"),f=c.getAttribute("data-sanity")!==null,d=o!==null?o===l:!0;return a?.sanity&&!u&&ke(a.sanity)&&Ir(e,a.sanity)&&d&&f&&s.push(a),s},[]);return i.length<=1?null:i}function na({handler:t,overlayElement:e,inFrame:n,inPopUp:r,optimisticActorReady:o}){let i=!1;const s=new Map,c=new WeakMap,a=new Set,u=new WeakMap,l=new WeakMap;let f,d,y,v=!1,m=[];const E=()=>m[m.length-1];function M(h,b){h.addEventListener("click",b.click,{capture:!0}),h.addEventListener("contextmenu",b.contextmenu,{capture:!0}),h.addEventListener("mousemove",b.mousemove,{once:!0,capture:!0}),h.addEventListener("mousedown",b.mousedown,{capture:!0})}function S(h,b){h.removeEventListener("click",b.click,{capture:!0}),h.removeEventListener("contextmenu",b.contextmenu,{capture:!0}),h.removeEventListener("mousemove",b.mousemove,{capture:!0}),h.removeEventListener("mousedown",b.mousedown,{capture:!0}),h.removeEventListener("mouseenter",b.mouseenter),h.removeEventListener("mouseleave",b.mouseleave)}function $({id:h,elements:b,handlers:x}){const{element:T,measureElement:O}=b;M(T,x),f.observe(O),t({type:"element/activate",id:h})}function k({id:h,elements:b,handlers:x}){const{element:T,measureElement:O}=b;S(T,x),f.unobserve(O),m=m.filter(F=>F!==T),t({type:"element/deactivate",id:h})}function R(h){if(!(!n&&!r||!o))for(const b of m){if(h===b){const x=c.get(h)?.sanity;if(!x||!ke(x))return;if(Sn(h,x,a,c)){const T=h.style.cursor;T&&l.set(h,T),t({type:"overlay/setCursor",element:h,cursor:"move"});continue}}A(b)}}function A(h){const b=l.get(h);t({type:"overlay/setCursor",element:h,cursor:b})}function U({type:h,elements:b,commonSanity:x,targets:T}){const{element:O,measureElement:F}=b,Y={click(B){const J=B.target;if(O===E()&&O.contains(J)){n&&(B.preventDefault(),B.stopPropagation());const le=c.get(O)?.sanity;le&&!v&&t({type:"element/click",id:W,sanity:le})}},contextmenu(B){if(!("path"in x)||!n&&!r||!o||!x.path.split(".").pop()?.includes("[_key=="))return;const J=B.target;O===E()&&O.contains(J)&&((n||r)&&(B.preventDefault(),B.stopPropagation()),t({type:"element/contextmenu",id:W,position:{x:B.clientX,y:B.clientY},sanity:x}))},mousedown(B){if(B.preventDefault(),B.currentTarget!==m.at(-1)||O.getAttribute("data-sanity-drag-disable")||!n&&!r||!o)return;const J=c.get(O)?.sanity;if(!J||!ke(J)||!Ze(J.path))return;const le=Sn(O,x,a,c);le&&Js({element:O,handler:t,mouseEvent:B,overlayGroup:le,target:J,onSequenceStart:()=>{v=!0},onSequenceEnd:()=>{setTimeout(()=>{v=!1},250)}})},mousemove(B){Y.mouseenter(B);const J=B.currentTarget;J&&(J.addEventListener("mouseenter",Y.mouseenter),J.addEventListener("mouseleave",Y.mouseleave))},mouseenter(){document.querySelector("vercel-live-feedback")&&O.closest("[data-vercel-edit-info]")||O.closest("[data-vercel-edit-target]")||(m.push(O),t({type:"element/mouseenter",id:W,rect:me(O)}),R(O))},mouseleave(B){function J(){m.pop();const re=E();if(t({type:"element/mouseleave",id:W}),re){R(re);const se=c.get(re);se&&t({type:"element/mouseenter",id:se.id,rect:me(re)})}A(O)}function le(re){const se=we=>{const{relatedTarget:de}=we;dt(de)?de&&Ee(de)&&(re.removeEventListener("mouseleave",se),le(de)):(re.removeEventListener("mouseleave",se),J())};re.addEventListener("mouseleave",se)}const{relatedTarget:ze}=B,Se=dt(ze),Fe=e.contains(Se);if(Ee(Se)&&Fe)return le(Se);J()}},W=vr(),ie={type:h,id:W,elements:b,sanity:x,handlers:Y};a.add(O),u.set(F,O),s.set(W,O),c.set(O,ie),d?.observe(O),t({type:"element/register",elementType:h,id:W,element:O,rect:me(O),sanity:x,dragDisabled:!!O.getAttribute("data-sanity-drag-disable"),targets:T.map(B=>({sanity:B.sanity,element:B.elements.element}))}),i&&$(ie)}function C(h){const{element:b}=h.elements,x=c.get(b);x&&(c.set(b,{...x,sanity:h.commonSanity}),t({type:"element/update",elementType:x.type,id:x.id,rect:me(b),sanity:h.commonSanity,targets:h.targets.map(T=>({sanity:T.sanity,element:T.elements.element}))}))}function N(h){const b=Er(h);for(const x of b){if(x.type==="group"){for(const O of x.targets){const F=c.get(O.elements.element);F&&F.type==="element"&&_(O.elements.element)}x.targets.length===0&&_(x.elements.element)}if(!x.commonSanity)continue;const{element:T}=x.elements;c.has(T)?C(x):U(x)}}function _(h){const b=c.get(h);if(b){const{id:x,handlers:T}=b;S(h,T),f.unobserve(h),c.delete(h),a.delete(h),s.delete(x),t({type:"element/unregister",id:x})}}function j(h){let b=!1;for(const x of h){const{target:T,type:O}=x,F=O==="characterData"?T.parentElement:T;if(!(F===e||e.contains(F))&&(b=!0,Ee(F))){const Y=F.parentElement?.closest("[data-sanity-edit-group]")||null,W=Ee(Y)?Y:F;N({childNodes:[W]})}}if(b)for(const x of a)x.isConnected||_(x),c.get(x)?.type==="group"&&!x.hasAttribute("data-sanity-edit-group")&&_(x)}function P(h){const b=c.get(h);b&&t({type:"element/updateRect",id:b.id,rect:me(h)})}function I(h){for(const b of h){const x=b.target;if(Ee(x)){const T=u.get(x);if(!T)return;P(T)}}}function z(h){if(i)for(const b of h){const{target:x}=b,T=Ee(x)&&c.get(x);T&&(b.isIntersecting?$(T):k(T))}}function w(h){const b=dt(h.target);if(b){b.dataset.sanityOverlayElement==="capture"&&(h.preventDefault(),h.stopPropagation());return}m=[],t({type:"overlay/blur"})}function D(){m=[],t({type:"overlay/reset-mouse-state"})}function K(){for(const h of a)P(h)}function L(h){h.key==="Escape"&&(m=[],t({type:"overlay/blur"}))}function G(h){const{target:b}=h;if(!(b===window.document||!Ee(b)))for(const x of a)b.contains(x)&&P(x)}function V(){i||(d=new IntersectionObserver(z,{threshold:.3}),a.forEach(h=>d.observe(h)),t({type:"overlay/activate"}),i=!0)}function H(){i&&(d?.disconnect(),a.forEach(h=>{const b=c.get(h);b&&k(b)}),t({type:"overlay/deactivate"}),i=!1)}function X(h){const{id:b}=h.detail,x=s.get(b);if(!x)return;const T=c.get(x)?.sanity;T&&t({type:"element/click",id:b,sanity:T})}function Z(){window.removeEventListener("click",w),window.removeEventListener("contextmenu",w),window.removeEventListener("sanity-overlay/exclusive-plugin-closed",D),window.removeEventListener("sanity-overlay/label-click",X),window.removeEventListener("keydown",L),window.removeEventListener("resize",K),window.removeEventListener("scroll",G),y.disconnect(),f.disconnect(),a.forEach(h=>{_(h)}),s.clear(),a.clear(),m=[],H()}function Q(){window.addEventListener("click",w),window.addEventListener("contextmenu",w),window.addEventListener("sanity-overlay/exclusive-plugin-closed",D),window.addEventListener("sanity-overlay/label-click",X),window.addEventListener("keydown",L),window.addEventListener("resize",K),window.addEventListener("scroll",G,{capture:!0,passive:!0}),f=new ResizeObserver(I),y=new MutationObserver(j),y.observe(document.body,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),N(document.body),V()}return window.document.fonts.ready.then(()=>{for(const h of a)P(h)}),Q(),{activate:V,deactivate:H,destroy:Z}}const ra=g.createContext(null);function ft(t){if(!t)return p.jsx(on,{});if(t.type==="string")return p.jsx(xt,{});if(t.type==="number")return p.jsx(sn,{});const{value:e}=t;if("icon"in t&&t.icon)return p.jsx("div",{dangerouslySetInnerHTML:{__html:t.icon}});const{type:n}=e;if(n==="string")return p.jsx(xt,{});if(n==="boolean")return p.jsx(Zr,{});if(n==="number")return p.jsx(sn,{});if(n==="array"||n==="union")return(Array.isArray(e.of)?e.of:[e.of]).some(r=>"name"in r&&r.name==="block")?p.jsx(Qr,{}):p.jsx(eo,{});if(n==="object"){if(t.name==="image")return p.jsx(to,{});if(t.name==="block")return p.jsx(xt,{})}return p.jsx(on,{})}const oa=ro`
  overflow-y: scroll;
  overscroll-behavior: contain;
  -ms-overflow-style: none;
  scrollbar-width: none;

  &:before {
    content: '';
    display: block;
    height: calc(100% + 1px);
    position: absolute;
    top: 0;
    width: 100%;
    z-index: -1;
  }
`,ia=ue.div`
  height: 100%;
  inset: 0;
  pointer-events: all;
  position: fixed;
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;

  ${t=>t.$blockScroll&&oa}
`,sa=ue.div`
  background: transparent;
  height: 100%;
  inset: 0;
  position: absolute;
  width: 100%;
`,aa=t=>{const e=q.c(2);let n;return e[0]!==t?(n=p.jsx(no,{children:p.jsx(Sr,{...t})}),e[0]=t,e[1]=n):n=e[1],n},Sr=t=>{const e=q.c(7),{children:n,onDismiss:r,setBoundaryElement:o,blockScroll:i}=t,s=i===void 0?!0:i,c=ca;let a;e[0]!==r?(a=p.jsx(sa,{onMouseDownCapture:()=>{r?.()}}),e[0]=r,e[1]=a):a=e[1];let u;return e[2]!==s||e[3]!==n||e[4]!==o||e[5]!==a?(u=p.jsxs(ia,{"data-sanity-overlay-element":!0,ref:o,onClick:c,$blockScroll:s,children:[a,n]}),e[2]=s,e[3]=n,e[4]=o,e[5]=a,e[6]=u):u=e[6],u};function ca(t){t.stopPropagation()}function be(t){return{type:"log",name:t.name,version:t.version,description:t.description,maxSampleRate:t.maxSampleRate,schema:void 0}}const ua={"Visual Editing Drag Sequence Completed":be({name:"Visual Editing Drag Sequence Completed",description:"An array is successfully reordered using drag and drop.",version:1}),"Visual Editing Drag Minimap Enabled":be({name:"Visual Editing Drag Minimap Enabled",description:"The zoomed-out minimap view is enabled during a drag sequence.",version:1}),"Visual Editing Context Menu Item Removed":be({name:"Visual Editing Context Menu Item Removed",description:"An item is removed using the Context Menu.",version:1}),"Visual Editing Context Menu Item Duplicated":be({name:"Visual Editing Context Menu Item Duplicated",description:"An item is duplicated using the Context Menu.",version:1}),"Visual Editing Context Menu Item Moved":be({name:"Visual Editing Context Menu Item Moved",description:"An item is moved using the Context Menu.",version:1}),"Visual Editing Context Menu Item Inserted":be({name:"Visual Editing Context Menu Item Inserted",description:"An item is inserted using the Context Menu.",version:1}),"Visual Editing Insert Menu Item Inserted":be({name:"Visual Editing Insert Menu Item Inserted",description:"An item is inserted using the Insert Menu.",version:1}),"Visual Editing Overlay Clicked":be({name:"Visual Editing Overlay Clicked",description:"An Overlay is clicked.",version:1})},kr=g.createContext(void 0);function Mr(){const t=g.useContext(kr);if(!t)throw new Error("Telemetry context is missing");return t}const la={"insert-menu.filter.all-items":"All","insert-menu.search.no-results":"No results","insert-menu.search.placeholder":"Filter typesâ€¦","insert-menu.toggle-grid-view.tooltip":"Toggle grid view","insert-menu.toggle-list-view.tooltip":"Toggle list view"},da=t=>{const e=q.c(11),{node:n,onSelect:r}=t;let o;e[0]!==n.options?.insertMenu?(o=n.options?.insertMenu||{},e[0]=n.options?.insertMenu,e[1]=o):o=e[1];const i=o;let s;e[2]!==i.views?(s=i.views?.map(pa),e[2]=i.views,e[3]=s):s=e[3];const c=s;let a;e[4]!==n.of?(a=n.of.map(fa),e[4]=n.of,e[5]=a):a=e[5];let u;return e[6]!==i||e[7]!==r||e[8]!==a||e[9]!==c?(u=p.jsx(oo,{...i,labels:la,schemaTypes:a,onSelect:r,views:c}),e[6]=i,e[7]=r,e[8]=a,e[9]=c,e[10]=u):u=e[10],u};function pa(t){return t.name==="grid"?{...t,previewImageUrl:e=>t.previewImageUrls?.[e]}:t}function fa(t){return{...t,icon:ft(t)}}const _t=t=>{const e=q.c(10);let n,r,o;e[0]!==t?({children:n,style:o,...r}=t,e[0]=t,e[1]=n,e[2]=r,e[3]=o):(n=e[1],r=e[2],o=e[3]);let i;e[4]!==o?(i={...o,pointerEvents:"all"},e[4]=o,e[5]=i):i=e[5];let s;return e[6]!==n||e[7]!==r||e[8]!==i?(s=p.jsx("div",{style:i,"data-sanity-overlay-element":!0,...r,children:n}),e[6]=n,e[7]=r,e[8]=i,e[9]=s):s=e[9],s},ma="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let ya=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=ma[n[t]&63];return e};function ha(t){return t!==null&&typeof t=="object"&&typeof t._key=="string"&&t._key||null}function vt(t,e){if(typeof e=="number")return va(t.length,e);if(gt(e)){const n=t.findIndex(r=>ha(r)===e._key);return n===-1?null:n}throw new Error(`Expected path segment to be addressing a single array item either by numeric index or by '_key'. Instead saw ${JSON.stringify(e)}`)}function ga(t,e){return t==="before"?e:e+1}function va(t,e){if(t===0&&(e===-1||e===0))return 0;const n=e<0?t+e:e;return n>=t||n<0?null:n}function wt(t,e,n,r){const o=t.slice();return o.splice(e,n,...r||[]),o}function jr(t,e){const n={...t};for(const r of e)delete n[r];return n}function en(t,e){if(!Array.isArray(e))throw new TypeError('Cannot apply "insert()" on non-array value');const n=vt(e,t.referenceItem);if(n===null)throw new Error(`Found no matching array element to insert ${t.position}`);return e.length===0?t.items:wt(e,ga(t.position,n),0,t.items)}function wa(t,e){if(!Array.isArray(e))throw new TypeError('Cannot apply "upsert()" on non-array value');if(t.items.length===0)return e;const n={},r=[];t.items.forEach((s,c)=>{const a=e.findIndex(u=>u?._key===s._key);a>=0?n[a]=c:r.push(s)});const o=Object.keys(n);if(o.length===0&&r.length==0)return e;const i=[...e];for(const s of o){const c=Number(s);i[c]=t.items[n[c]]}return en({items:r,referenceItem:t.referenceItem,position:t.position},i)}function ba(t,e){if(!Array.isArray(e))throw new TypeError('Cannot apply "insertIfMissing()" on non-array value');if(t.items.length===0)return e;const n=t.items.filter(r=>!e.find(o=>r._key===o?._key));return n.length===0?e:en({items:n,referenceItem:t.referenceItem,position:t.position},e)}function xa(t,e){if(!Array.isArray(e))throw new TypeError('Cannot apply "replace()" on non-array value');const n=vt(e,t.referenceItem);if(n===null)throw new Error("Found no matching array element to replace");return wt(e,n,t.items.length,t.items)}function Ea(t,e){if(!Array.isArray(e))throw new TypeError('Cannot apply "remove()" on non-array value');const n=vt(e,t.referenceItem);if(n===null)throw new Error("Found no matching array element to replace");return wt(e,n,1,[])}function Ia(t,e){if(!Array.isArray(e))throw new TypeError('Cannot apply "truncate()" on non-array value');return typeof t.endIndex=="number"?e.slice(0,t.startIndex).concat(e.slice(t.endIndex)):e.slice(0,t.startIndex)}function Sa(t,e){return t.value}function ka(t,e){return e??t.value}function Ma(t){}function ja(t,e){if(typeof e!="number")throw new TypeError('Cannot apply "inc()" on non-numeric value');return e+t.amount}function Ca(t,e){if(typeof e!="number")throw new TypeError('Cannot apply "dec()" on non-numeric value');return e-t.amount}const _a=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty);function Pa(t){for(const e in t)if(_a(t,e))return!1;return!0}function $a(t,e){if(!Bt(e))throw new TypeError('Cannot apply "unassign()" on non-object value');return t.keys.length===0?e:jr(e,t.keys)}function Ra(t,e){if(!Bt(e))throw new TypeError('Cannot apply "assign()" on non-object value');return Pa(t.value)?e:{...e,...t.value}}function Aa(t,e){if(typeof e!="string")throw new TypeError('Cannot apply "diffMatchPatch()" on non-string value');return io(so(t.value),e)[0]}var kn=Object.freeze({__proto__:null,assign:Ra,dec:Ca,diffMatchPatch:Aa,inc:ja,insert:en,insertIfMissing:ba,remove:Ea,replace:xa,set:Sa,setIfMissing:ka,truncate:Ia,unassign:$a,unset:Ma,upsert:wa});function Ta(t,e){if(!(t.type in kn))throw new Error(`Invalid operation type: "${t.type}"`);return kn[t.type](t,e)}function Kt(t,e){return t.reduce((n,r)=>Cr(r,n),e)}function Cr(t,e){return tn(t.path,t.op,e)}function tn(t,e,n){if(!Na(t))return Ta(e,n);const[r,...o]=t;if(Yn(r)&&Array.isArray(n))return Oa(r,o,e,n);if(di(r)&&Bt(n))return Da(r,o,e,n);throw new Error(`Cannot apply operation of type "${e.type}" to path ${ne(t)} on ${typeof n} value`)}function Da(t,e,n,r){const o=r[t];if(o===void 0&&e.length>0)return r;const i=tn(e,n,o);return i===void 0?jr(r,[t]):i===o?r:{...r,[t]:i}}function Oa(t,e,n,r){const o=vt(r,t);if(o===null||o===-1)return r;const i=r[o],s=tn(e,n,i);return s===i?r:wt(r,o,1,s===void 0?[]:[s])}function Na(t){return t.length>0}function La(t,e){if(t.options?.ifRevision&&e._rev!==t.options.ifRevision)throw new Error("Revision mismatch");if(t.id!==e._id)throw new Error(`Document id mismatch. Refusing to apply mutation for document with id="${t.id}" on the given document with id="${e._id}"`);return Kt(t.patches,e)}function nn(t){return"_id"in t}function Ua(t,e){return nn(t)?t:{...t,_id:e()}}function _r(t,e){if(t.length===0)return e;let n=e;for(const r of t){if(Yn(r)){if(!Array.isArray(n))return;if(gt(r)){n=n.find(o=>o._key===r._key);continue}n=n[r];continue}n=n[r]}return n}var Pt,Mn;function za(){if(Mn)return Pt;Mn=1;var t=ao(),e=(function(){try{var n=t(Object,"defineProperty");return n({},"",{}),n}catch{}})();return Pt=e,Pt}var $t,jn;function Fa(){if(jn)return $t;jn=1;var t=za();function e(n,r,o){r=="__proto__"&&t?t(n,r,{configurable:!0,enumerable:!0,value:o,writable:!0}):n[r]=o}return $t=e,$t}var Rt,Cn;function Ga(){if(Cn)return Rt;Cn=1;var t=Fa(),e=co(),n=Object.prototype,r=n.hasOwnProperty,o=e(function(i,s,c){r.call(i,c)?i[c].push(s):t(i,c,[s])});return Rt=o,Rt}var qa=Ga();const Ka=ei(qa);function mt(t){if(t.type==="patch")return t.id;if(t.type==="create")return t.document._id;if(t.type==="delete")return t.id;if(t.type==="createIfNotExists"||t.type==="createOrReplace")return t.document._id;throw new Error("Invalid mutation type")}function _n(t,e){return e.reduce((n,r)=>{const o=Pr(n,r);if(o.status==="error")throw new Error(o.message);return o.status==="noop"?n:o.after},t)}function Pr(t,e){if(e.type==="create")return Va(t,e);if(e.type==="createIfNotExists")return Wa(t,e);if(e.type==="delete")return Ha(t,e);if(e.type==="createOrReplace")return Ba(t,e);if(e.type==="patch")return Ya(t,e);throw new Error(`Invalid mutation type: ${e.type}`)}function Va(t,e){if(t)return{status:"error",message:"Document already exist"};const n=Ua(e.document,ya);return{status:"created",id:n._id,after:n}}function Wa(t,e){return nn(e.document)?t?{status:"noop"}:{status:"created",id:e.document._id,after:e.document}:{status:"error",message:"Cannot createIfNotExists on document without _id"}}function Ba(t,e){return nn(e.document)?t?{status:"updated",id:e.document._id,before:t,after:e.document}:{status:"created",id:e.document._id,after:e.document}:{status:"error",message:"Cannot createIfNotExists on document without _id"}}function Ha(t,e){return t?e.id!==t._id?{status:"error",message:"Delete mutation targeted wrong document"}:{status:"deleted",id:e.id,before:t,after:void 0}:{status:"noop"}}function Ya(t,e){if(!t)return{status:"error",message:"Cannot apply patch on nonexistent document"};const n=La(e,t);return t===n?{status:"noop"}:{status:"updated",id:e.id,before:t,after:n}}function Xa(t,e,n){const r=Object.create(null);for(const o of t){const i=mt(o);if(!i)throw new Error("Unable to get document id from mutation");const s=r[i]?.after||e.get(i),c=Pr(s,o);if(c.status==="error")throw new Error(c.message);let a=r[i];a||(a={before:s,after:s,mutations:[]},r[i]=a);const u=c.status==="noop"?s:c.after;e.set(i,u),a.after=u,a.mutations.push(o)}return Object.entries(r).map(([o,{before:i,after:s,mutations:c}])=>({id:o,status:s?i?"updated":"created":"deleted",mutations:c,before:i,after:s}))}function Ja(t,e){t.forEach(n=>{(n.status==="created"||n.status==="updated")&&e.set(n.id,n.after),n.status==="deleted"&&e.delete(n.id)})}function Za(){return po()}function $r(t,e,n){const r=[];for(const o of t.slice().reverse()){if(e(o))return r;r.push(o)}return r.reverse()}function rn(t,e){return ne(t)===ne(e)}function Qa(t,e){return(e.type==="set"||e.type==="unset")&&(t.type==="set"||t.type==="unset")}function ec(t){return rc(nc(tc(t)))}function tc(t){return t.reduce((e,n)=>{if(n.op.type!=="unset")return e.push(n),e;const r=e.filter(o=>!ci(n.path,o.path));return r.push(n),r},[])}function nc(t){return t.reduceRight((e,n)=>(e.find(r=>Qa(r.op,n.op)&&rn(r.path,n.path))||e.unshift(n),e),[])}function rc(t){return t.reduce((e,n)=>n.op.type!=="setIfMissing"?(e.push(n),e):($r(e,r=>r.op.type==="unset").find(r=>r.op.type==="setIfMissing"&&rn(r.path,n.path))||e.push(n),e),[])}function Rr(t,e){let n=t;return e.reduce((r,o)=>{const i=n;if(n=Cr(o,n),o.op.type==="set"&&typeof o.op.value=="string"){const s=_r(o.path,i);if(typeof s=="string"){const c={...o,op:{type:"diffMatchPatch",value:uo(lo(s,o.op.value))}};return r.flatMap(a=>rn(a.path,o.path)&&a.op.type==="diffMatchPatch"?[]:a).concat(c)}}return r.push(o),r},[])}function oc(t,e){return e.map(n=>({...n,mutations:ic(t,n.mutations)}))}function ic(t,e){return e.map((n,r)=>{if(n.type!=="patch")return n;const o=t.get(n.id);return o?sc(o,n):n})}function sc(t,e){return{...e,patches:Rr(t,e.patches)}}function ac(t){return cc(t,e=>!e.transaction).flatMap(e=>({...e[0],mutations:e.flatMap(n=>n.mutations)}))}function cc(t,e){const n=[];let r=[];return t.forEach(o=>{e(o)?r.push(o):(r.length>0&&n.push(r),r=[],n.push([o]))}),r.length>0&&n.push(r),n}function uc(t){return ac(t).map(e=>({...e,mutations:lc(e.mutations)})).map(e=>({...e,mutations:e.mutations.map(n=>n.type!=="patch"?n:{...n,patches:ec(n.patches)})}))}function lc(t){const e=Ka(t,mt);return Object.values(e).flatMap(n=>dc(pc(n)).flat().reduce((r,o)=>{const i=r[r.length-1];return(!i||i.type==="patch")&&o.type==="patch"?r.slice(0,-1).concat({...o,patches:(i?.patches||[]).concat(o.patches)}):r.concat(o)},[]))}function dc(t){return t.length===0?t:t.reduce((e,n)=>n.type!=="createIfNotExists"?(e.push(n),e):($r(e,r=>r.type==="delete").find(r=>r.type==="createIfNotExists")||e.push(n),e),[])}function pc(t){return t.length===0?t:t.reduce((e,n)=>n.type==="delete"?[n]:(e.push(n),e),[])}function Pn(t,e,n,r){let o=e;const i=r.map(c=>{const a=c.mutations.flatMap(u=>{if(mt(u)!==t)return[];const l=o;return o=_n(o,[u]),!l||u.type!=="patch"?u:{type:"dmpified",mutation:{...u,dmpPatches:Rr(l,u.patches),original:u.patches}}});return{...c,mutations:a}});let s=n;return i.map(c=>{const a=[];return c.mutations.forEach(u=>{if(u.type==="dmpified")try{s=Kt(u.mutation.dmpPatches,s),a.push(u)}catch{console.warn("Failed to apply dmp patch, falling back to original");try{s=Kt(u.mutation.original,s),a.push(u)}catch(l){throw new Error(`Failed to apply patch for document "${t}": ${l.message}`)}}else s=_n(s,[u])})}),[r.map(c=>({...c,mutations:c.mutations.map(a=>a.type!=="patch"||mt(a)!==t?a:{...a,patches:a.patches.map(u=>u.op.type!=="set"?u:{...u,op:{...u.op,value:_r(u.path,s)}})})})),s]}function fc(t){return t.map(e=>e.transaction&&e.id!==void 0?{id:e.id,mutations:e.mutations}:{id:Za(),mutations:e.mutations})}function Ar(t){const e=t.listen('*[!(_id in path("_.**"))]',{},{events:["welcome","mutation","reconnect"],includeResult:!1,includePreviousRevision:!1,visibility:"transaction",effectFormat:"mendoza",includeMutations:!1}).pipe(fo({resetOnRefCountZero:!0})),n=e.pipe(We(s=>s.type==="reconnect")),r=e.pipe(We(s=>s.type==="welcome")),o=e.pipe(We(s=>s.type==="mutation")),i=Ot(r,n).pipe(mo({bufferSize:1,refCount:!0})).pipe(We(s=>s.type==="welcome"));return Ot(i,o,n)}const Tr=zn({actions:{"assign error to context":ce({error:({event:t})=>t}),"clear error from context":ce({error:void 0}),"connect to server-sent events":ho({type:"connect"}),"listen to server-sent events":yo("server-sent events",{id:"listener",input:({context:t})=>({listener:t.sharedListener||Ar(t.client),id:t.id})}),"stop listening to server-sent events":Fn("listener"),"buffer remote mutation events":ce({mutationEvents:({event:t,context:e})=>(oe(t,"mutation"),[...e.mutationEvents,t])}),"restore stashed changes":ce({stagedChanges:({event:t,context:e})=>(oe(t,"xstate.done.actor.submitTransactions"),e.stashedChanges),stashedChanges:[]}),"rebase fetched remote snapshot":Nt(({enqueue:t})=>{t.assign(({event:e,context:n})=>{oe(e,"xstate.done.actor.getDocument");const r=n.remote;let o=e.output,i=!1;for(const a of n.mutationEvents)!a.effects?.apply||!a.previousRev&&a.transition!=="appear"||(!i&&a.previousRev===o?._rev&&(i=!0),i&&(o=$n(o,a.effects.apply,a.resultRev)));n.cache&&(!n.cache.has(n.id)||n.cache.get(n.id)._rev!==o?._rev)&&n.cache.set(n.id,o);const[s,c]=Pn(n.id,r===null?void 0:r,o===null?void 0:o,n.stagedChanges);return{remote:o,local:c,stagedChanges:s,mutationEvents:[]}}),t.sendParent(({context:e})=>({type:"rebased.remote",id:e.id,document:e.remote}))}),"apply mendoza patch":ce(({event:t,context:e})=>{oe(t,"mutation");const n=e.remote;if(t.transactionId===n?._rev)return{};const r=$n(n,t.effects.apply,t.resultRev);e.cache&&(!e.cache.has(e.id)||e.cache.get(e.id)._rev!==r?._rev)&&e.cache.set(e.id,r);const[o,i]=Pn(e.id,n===null?void 0:n,r===null?void 0:r,e.stagedChanges);return{remote:r,local:i,stagedChanges:o}}),"increment fetch attempts":ce({fetchRemoteSnapshotAttempts:({context:t})=>t.fetchRemoteSnapshotAttempts+1}),"reset fetch attempts":ce({fetchRemoteSnapshotAttempts:0}),"increment submit attempts":ce({submitTransactionsAttempts:({context:t})=>t.submitTransactionsAttempts+1}),"reset submit attempts":ce({submitTransactionsAttempts:0}),"stage mutation":ce({stagedChanges:({event:t,context:e})=>(oe(t,"mutate"),[...e.stagedChanges,{transaction:!1,mutations:t.mutations}])}),"stash mutation":ce({stashedChanges:({event:t,context:e})=>(oe(t,"mutate"),[...e.stashedChanges,{transaction:!1,mutations:t.mutations}])}),"rebase local snapshot":Nt(({enqueue:t})=>{t.assign({local:({event:e,context:n})=>{oe(e,"mutate");const r=new Map;n.local&&r.set(n.id,n.local);const o=Xa(e.mutations,r);return Ja(o,r),r.get(n.id)}}),t.sendParent(({context:e})=>({type:"rebased.local",id:e.id,document:e.local}))}),"send pristine event to parent":Et(({context:t})=>({type:"pristine",id:t.id})),"send sync event to parent":Et(({context:t})=>({type:"sync",id:t.id,document:t.remote})),"send mutation event to parent":Et(({context:t,event:e})=>(oe(e,"mutation"),{type:"mutation",id:t.id,previousRev:e.previousRev,resultRev:e.resultRev,effects:e.effects}))},actors:{"server-sent events":vo(({input:t})=>{const{listener:e,id:n}=t;return wo(()=>e).pipe(We(r=>r.type==="welcome"||r.type==="reconnect"||r.type==="mutation"&&r.documentId===n),bo(xo))}),"fetch remote snapshot":pt(async({input:t,signal:e})=>{const{client:n,id:r}=t;return await n.getDocument(r,{signal:e}).catch(o=>{if(!(o instanceof Error&&o.name==="AbortError"))throw o})}),"submit mutations as transactions":pt(async({input:t,signal:e})=>{const{client:n,transactions:r}=t;for(const o of r){if(e.aborted)return;await n.dataRequest("mutate",er(o),{visibility:"async",returnDocuments:!1,signal:e}).catch(i=>{if(!(i instanceof Error&&i.name==="AbortError"))throw i})}})},delays:{fetchRemoteSnapshotTimeout:({context:t})=>Math.pow(2,t.fetchRemoteSnapshotAttempts)*1e3,submitTransactionsTimeout:({context:t})=>Math.pow(2,t.submitTransactionsAttempts)*1e3}}).createMachine({id:"document-mutator",context:({input:t})=>({client:t.client.withConfig({allowReconfigure:!1}),sharedListener:t.sharedListener,id:t.id,remote:void 0,local:void 0,mutationEvents:[],stagedChanges:[],stashedChanges:[],error:void 0,fetchRemoteSnapshotAttempts:0,submitTransactionsAttempts:0,cache:t.cache}),entry:["connect to server-sent events"],on:{mutate:{actions:["rebase local snapshot","stage mutation"]}},initial:"disconnected",states:{disconnected:{on:{connect:{target:"connecting",actions:["listen to server-sent events"]}}},connecting:{on:{welcome:"connected",reconnect:"reconnecting",error:"connectFailure"},tags:["busy"]},connectFailure:{on:{connect:{target:"connecting",actions:["listen to server-sent events"]}},entry:["stop listening to server-sent events","assign error to context"],exit:["clear error from context"],tags:["error"]},reconnecting:{on:{welcome:{target:"connected"},error:{target:"connectFailure"}},tags:["busy","error"]},connected:{on:{mutation:{actions:["buffer remote mutation events"]},reconnect:"reconnecting"},entry:["clear error from context"],initial:"loading",states:{loading:{invoke:{src:"fetch remote snapshot",id:"getDocument",input:({context:t})=>({client:t.client,id:t.id}),onError:{target:"loadFailure"},onDone:{target:"loaded",actions:["rebase fetched remote snapshot","reset fetch attempts"]}},tags:["busy"]},loaded:{entry:["send sync event to parent"],on:{mutation:{actions:["apply mendoza patch","send mutation event to parent"]}},initial:"pristine",states:{pristine:{on:{mutate:{actions:["rebase local snapshot","stage mutation"],target:"dirty"}},tags:["ready"]},dirty:{on:{submit:"submitting"},tags:["ready"]},submitting:{on:{mutate:{actions:["rebase local snapshot","stash mutation"]}},invoke:{src:"submit mutations as transactions",id:"submitTransactions",input:({context:t})=>{const e=new Map;return e.set(t.id,t.remote),{client:t.client,transactions:fc(oc(e,uc(t.stagedChanges)))}},onError:{target:"submitFailure"},onDone:{target:"pristine",actions:["restore stashed changes","reset submit attempts","send pristine event to parent"]}},tags:["busy","ready"]},submitFailure:{exit:["clear error from context"],after:{submitTransactionsTimeout:{actions:["increment submit attempts"],target:"submitting"}},on:{retry:"submitting"},tags:["error","ready"]}}},loadFailure:{exit:["clear error from context"],after:{fetchRemoteSnapshotTimeout:{actions:["increment fetch attempts"],target:"loading"}},on:{retry:"loading"},tags:["error"]}}}}});function $n(t,e,n){const r=go(mc(t),e);return r?Object.assign(r,{_rev:n}):null}function mc(t){if(!t)return null;const{_rev:e,...n}=t;return n}const yc=t=>{const e=pt(async({input:r,signal:o})=>{const{id:i}=r,{snapshot:s}=await t.fetch("visual-editing/fetch-snapshot",{documentId:i},{signal:o});return s}),n=pt(async({input:r})=>{const{transactions:o}=r;for(const i of o){const s=Ui.encodeTransaction(i);return t.post("visual-editing/mutate",s)}});return Tr.provide({actions:{"send sync event to parent":Nt(({enqueue:r})=>{r.sendParent(({context:o})=>({type:"sync",id:o.id,document:o.remote})),r.emit(({context:o})=>({type:"ready",snapshot:o.local}))})},actors:{"fetch remote snapshot":e,"submit mutations as transactions":n}})},hc=zn({actions:{"emit sync event":rt(({event:t})=>(oe(t,"sync"),t)),"emit mutation event":rt(({event:t})=>(oe(t,"mutation"),t)),"emit rebased event":rt(({event:t})=>(oe(t,["rebased.local","rebased.remote"]),t)),"emit pristine event":rt(({event:t})=>(oe(t,["pristine"]),t)),"add document actor":ce({documents:({context:t,event:e,spawn:n})=>{oe(e,"observe");const r=e.documentId;return t.documents[r]?t.documents:{...t.documents,[r]:n("documentMutatorMachine",{input:{id:r,client:t.client,sharedListener:t.sharedListener||Ar(t.client)},id:r})}}}),"stop remote snapshot":Fn(({context:t,event:e})=>(oe(e,"unobserve"),t.documents[e.documentId])),"remove remote snapshot from context":ce({documents:({context:t,event:e})=>{if(oe(e,"unobserve"),!t.documents[e.documentId])return t.documents;const{[e.documentId]:n,...r}=t.documents;return r}})},actors:{documentMutatorMachine:Tr}}).createMachine({id:"dataset-mutator",context:({input:t})=>({documents:{},client:t.client,sharedListener:t.sharedListener}),on:{sync:{actions:["emit sync event"]},mutation:{actions:["emit mutation event"]},"rebased.*":{actions:["emit rebased event"]},pristine:{actions:["emit pristine event"]},observe:{actions:["add document actor"]},unobserve:{actions:["stop remote snapshot","remove remote snapshot from context"]}},initial:"pristine",states:{pristine:{}}}),gc=t=>hc.provide({actors:{documentMutatorMachine:yc(t)}}),vc=new Set;let Rn=null;function He(t){if(Rn!==t){Rn=t;for(const e of vc)e()}}const wc=t=>{const e=q.c(8),{comlink:n,history:r}=t;let o,i;e[0]!==n||e[1]!==r?(o=()=>n?.on("presentation/navigate",a=>{r?.update(a)}),i=[n,r],e[0]=n,e[1]=r,e[2]=o,e[3]=i):(o=e[2],i=e[3]),g.useEffect(o,i);let s,c;return e[4]!==n||e[5]!==r?(s=()=>{if(r)return r.subscribe(a=>{a.title=a.title||document.title,n?.post("visual-editing/navigate",a)})},c=[n,r],e[4]=n,e[5]=r,e[6]=s,e[7]=c):(s=e[6],c=e[7]),g.useEffect(s,c),null},bc=t=>{const e=q.c(3),{comlink:n}=t;let r,o;return e[0]!==n?(r=()=>{const i=()=>{n.post("visual-editing/meta",{title:document.title})},s=new MutationObserver(c=>{const[a]=c;a.target.nodeName==="TITLE"&&i()});return s.observe(document.head,{subtree:!0,characterData:!0,childList:!0}),i(),()=>s.disconnect()},o=[n],e[0]=n,e[1]=r,e[2]=o):(r=e[1],o=e[2]),g.useEffect(r,o),null};function xc(t){if(t){const{top:e,right:n,bottom:r,left:o}=t;if(o||e)return{node:(o??e).sanity,position:"after"};if(n||r)return{node:(n??r).sanity,position:"before"}}}function Ec(){const t=q.c(4),{getDocument:e}=lr();let n,r;t[0]!==e?(n=()=>{const s=c=>{const{insertPosition:a,target:u,preventInsertDefault:l}=c.detail;if(l)return;const f=xc(a);if(f){const d=e(u.id),{node:y,position:v}=f,{key:m,hasExplicitKey:E}=Ue(u),{path:M,key:S}=Ue(y);M&&S&&S!==m&&d.patch(async $=>{const{getSnapshot:k}=$,R=await k(),A=Le(R,u.path);return E?[ve(M,un({_key:m})),ve(M,Ye(A,v,{_key:S}))]:[ve(M,un(~~m)),ve(M,Ye(A,v,S>m?~~S-1:~~S))]})}};return window.addEventListener("sanity/dragEnd",s),()=>{window.removeEventListener("sanity/dragEnd",s)}},r=[e],t[0]=e,t[1]=n,t[2]=r):(n=t[1],r=t[2]),g.useEffect(n,r);const o=Ic;let i;return t[3]===Symbol.for("react.memo_cache_sentinel")?(i={dispatchDragEndEvent:o},t[3]=i):i=t[3],i}function Ic(t){const e=new CustomEvent("sanity/dragEnd",{detail:t,cancelable:!0});window.dispatchEvent(e)}const Dr=g.createContext(null);function Or(){const t=g.useContext(Dr);if(!t)throw new Error("Schema context is missing");return t}function Sc(t,e){if(!t.type)throw new Error("Node type is missing");return()=>e.patch(async({getSnapshot:n})=>as(t,await n()))}function Ne(t,e,n,r){if(!t.type)throw new Error("Node type is missing");return()=>e.patch(()=>cs(t,n,r))}function kc(t,e){if(!t.type)throw new Error("Node type is missing");return()=>e.patch(async({getSnapshot:n})=>ss(t,await n()))}function Mc(t){const{node:e,field:n,parent:r,doc:o}=t;return n?.type==="arrayItem"?jc({node:e,field:n,doc:o}):r?.type==="union"?Cc({node:e,parent:r,doc:o}):Promise.resolve([])}function Nr(t){const{node:e,doc:n}=t;return n?[{type:"action",label:"Duplicate",icon:Bo,action:kc(e,n),telemetryEvent:"Visual Editing Context Menu Item Duplicated"}]:[]}function Lr(t){const{node:e,doc:n}=t;return n?[{type:"action",label:"Remove",icon:Ho,action:Sc(e,n),telemetryEvent:"Visual Editing Context Menu Item Removed"}]:[]}async function Ur(t,e=!0){const{node:n,doc:r}=t;if(!r)return[];const o=[],i=[],[s,c,a,u]=await Promise.all([ot(n,r,"previous"),ot(n,r,"next"),ot(n,r,"first"),ot(n,r,"last")]);return a.length&&i.push({type:"action",label:"To top",icon:Yo,action:()=>r.patch(a),telemetryEvent:"Visual Editing Context Menu Item Moved"}),s.length&&i.push({type:"action",label:"Up",icon:Xo,action:()=>r.patch(s),telemetryEvent:"Visual Editing Context Menu Item Moved"}),c.length&&i.push({type:"action",label:"Down",icon:Jo,action:()=>r.patch(c),telemetryEvent:"Visual Editing Context Menu Item Moved"}),u.length&&i.push({type:"action",label:"To bottom",icon:Zo,action:()=>r.patch(u),telemetryEvent:"Visual Editing Context Menu Item Moved"}),i.length&&(o.push({type:"group",label:"Move",icon:Qo,items:i}),e&&o.push({type:"divider"})),o}async function jc(t){const{node:e,field:n,doc:r}=t,o=[];return o.push(...Nr(t)),o.push(...Lr(t)),o.push(...await Ur(t)),o.push({type:"action",label:"Insert before",icon:Wn,action:Ne(e,r,n.name,"before"),telemetryEvent:"Visual Editing Context Menu Item Inserted"}),o.push({type:"action",label:"Insert after",icon:Wt,action:Ne(e,r,n.name,"after"),telemetryEvent:"Visual Editing Context Menu Item Inserted"}),o}const An=t=>{const e=q.c(12),{label:n,parent:r,width:o,onSelect:i,boundaryElement:s}=t;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=["left-start","right","left","right-end","left-end","bottom","top"],e[0]=c):c=e[0];let a;e[1]===Symbol.for("react.memo_cache_sentinel")?(a=[4,4,4,4],e[1]=a):a=e[1];let u;e[2]!==s||e[3]!==o?(u={arrow:!1,constrainSize:!0,floatingBoundary:s,padding:0,placement:"right-start",fallbackPlacements:c,preventOverflow:!0,width:o,__unstable_margins:a},e[2]=s,e[3]=o,e[4]=u):u=e[4];let l;e[5]!==i||e[6]!==r?(l=p.jsx(da,{node:r,onSelect:i}),e[5]=i,e[6]=r,e[7]=l):l=e[7];let f;return e[8]!==n||e[9]!==u||e[10]!==l?(f=p.jsx(Vn,{fontSize:1,icon:Wt,padding:2,popover:u,space:2,text:n,children:l}),e[8]=n,e[9]=u,e[10]=l,e[11]=f):f=e[11],f};async function Cc(t){const{doc:e,node:n,parent:r}=t,o=[];if(o.push(...Nr(t)),o.push(...Lr(t)),o.push(...await Ur(t)),r.options?.insertMenu){const i=(r.options.insertMenu||{}).views?.some(s=>s.name==="grid")?0:void 0;o.push({type:"custom",component:({boundaryElement:s,sendTelemetry:c})=>p.jsx(An,{label:"Insert before",onSelect:a=>{Ne(n,e,a.name,"before")(),c("Visual Editing Context Menu Item Inserted",null)},parent:r,width:i,boundaryElement:s})}),o.push({type:"custom",component:({boundaryElement:s,sendTelemetry:c})=>p.jsx(An,{label:"Insert after",onSelect:a=>{Ne(n,e,a.name,"after")(),c("Visual Editing Context Menu Item Inserted",null)},parent:r,width:i,boundaryElement:s})})}else o.push({type:"group",label:"Insert before",icon:Wn,items:r.of.filter(i=>i.type==="unionOption").map(i=>({type:"action",icon:ft(i),label:i.name==="block"?"Paragraph":i.title||i.name,action:Ne(n,e,i.name,"before"),telemetryEvent:"Visual Editing Context Menu Item Inserted"}))}),o.push({type:"group",label:"Insert after",icon:Wt,items:r.of.filter(i=>i.type==="unionOption").map(i=>({type:"action",label:i.name==="block"?"Paragraph":i.title||i.name,icon:ft(i),action:Ne(n,e,i.name,"after"),telemetryEvent:"Visual Editing Context Menu Item Inserted"}))});return o}const zr=[-4,4,-4,4];function Fr(t){const e=q.c(27),{node:n,onDismiss:r,boundaryElement:o}=t,i=Mr();let s;e[0]!==n||e[1]!==r||e[2]!==i?(s=()=>{n.type==="action"&&(n.action?.(),r?.(),n.telemetryEvent&&i(n.telemetryEvent,null))},e[0]=n,e[1]=r,e[2]=i,e[3]=s):s=e[3];const c=s;if(n.type==="divider"){let a;return e[4]===Symbol.for("react.memo_cache_sentinel")?(a=p.jsx(Vt,{}),e[4]=a):a=e[4],a}if(n.type==="action"){const a=!n.action;let u;return e[5]!==n.hotkeys||e[6]!==n.icon||e[7]!==n.label||e[8]!==c||e[9]!==a?(u=p.jsx(Lt,{fontSize:1,hotkeys:n.hotkeys,icon:n.icon,padding:2,space:2,text:n.label,disabled:a,onClick:c}),e[5]=n.hotkeys,e[6]=n.icon,e[7]=n.label,e[8]=c,e[9]=a,e[10]=u):u=e[10],u}if(n.type==="group"){const a=n.icon;let u;e[11]===Symbol.for("react.memo_cache_sentinel")?(u={arrow:!1,constrainSize:!0,placement:"right-start",fallbackPlacements:["left-start","right","left","right-end","left-end","bottom","top"],preventOverflow:!0,__unstable_margins:zr},e[11]=u):u=e[11];const l=n.label;let f;if(e[12]!==o||e[13]!==n.items||e[14]!==r){let y;e[16]!==o||e[17]!==r?(y=(v,m)=>p.jsx(Fr,{node:v,onDismiss:r,boundaryElement:o},m),e[16]=o,e[17]=r,e[18]=y):y=e[18],f=n.items.map(y),e[12]=o,e[13]=n.items,e[14]=r,e[15]=f}else f=e[15];let d;return e[19]!==n.icon||e[20]!==n.label||e[21]!==f?(d=p.jsx(Vn,{fontSize:1,icon:a,padding:2,popover:u,space:2,text:l,children:f}),e[19]=n.icon,e[20]=n.label,e[21]=f,e[22]=d):d=e[22],d}if(n.type==="custom"){const{component:a}=n;let u;return e[23]!==a||e[24]!==o||e[25]!==i?(u=p.jsx(a,{boundaryElement:o,sendTelemetry:i}),e[23]=a,e[24]=o,e[25]=i,e[26]=u):u=e[26],u}return null}const _c=t=>{const e=q.c(43),{node:n,onDismiss:r,position:o}=t,{x:i,y:s}=o,[c,a]=g.useState(null),{getField:u}=Or(),{getDocument:l}=lr();let f;e[0]!==u||e[1]!==n?(f=u(n),e[0]=u,e[1]=n,e[2]=f):f=e[2];const{field:d,parent:y}=f,v=d?.title||d?.name||"Unknown type",[m,E]=g.useState(void 0);let M,S;e[3]!==d||e[4]!==l||e[5]!==n||e[6]!==y?(M=()=>{(async()=>{const G=l(n.id);if(!G)return;const V=await Mc({node:n,field:d,parent:y,doc:G});E(V)})()},S=[d,n,y,l],e[3]=d,e[4]=l,e[5]=n,e[6]=y,e[7]=M,e[8]=S):(M=e[7],S=e[8]),g.useEffect(M,S);let $;e[9]!==i||e[10]!==s?($={getBoundingClientRect:()=>({bottom:s,left:i,right:i,top:s,width:0,height:0})},e[9]=i,e[10]=s,e[11]=$):$=e[11];const k=$;let R;e[12]!==d?(R=ft(d),e[12]=d,e[13]=R):R=e[13];const A=R;let U;e[14]===Symbol.for("react.memo_cache_sentinel")?(U={minWidth:120,maxWidth:160},e[14]=U):U=e[14];let C;e[15]!==A||e[16]!==m?(C=p.jsx(Oe,{flex:"none",children:m?p.jsx(ge,{size:1,children:A}):p.jsx(Oo,{size:1})}),e[15]=A,e[16]=m,e[17]=C):C=e[17];const N=m?v:"Loading...";let _;e[18]!==N?(_=p.jsx(qn,{flex:1,space:2,children:p.jsx(ge,{size:1,weight:"semibold",children:N})}),e[18]=N,e[19]=_):_=e[19];let j;e[20]!==C||e[21]!==_?(j=p.jsxs(Me,{gap:2,padding:2,children:[C,_]}),e[20]=C,e[21]=_,e[22]=j):j=e[22];let P;e[23]!==c||e[24]!==m||e[25]!==r?(P=m&&p.jsxs(p.Fragment,{children:[p.jsx(Vt,{}),m.map((G,V)=>p.jsx(Fr,{node:G,onDismiss:r,boundaryElement:c},V))]}),e[23]=c,e[24]=m,e[25]=r,e[26]=P):P=e[26];let I;e[27]!==j||e[28]!==P?(I=p.jsxs(Gn,{style:U,children:[j,P]}),e[27]=j,e[28]=P,e[29]=I):I=e[29];const z=`${i}-${s}`;let w;e[30]!==i||e[31]!==s?(w={position:"absolute",left:i,top:s},e[30]=i,e[31]=s,e[32]=w):w=e[32];let D;e[33]!==z||e[34]!==w?(D=p.jsx("div",{style:w},z),e[33]=z,e[34]=w,e[35]=D):D=e[35];let K;e[36]!==k||e[37]!==I||e[38]!==D?(K=p.jsx(No,{__unstable_margins:zr,arrow:!1,open:!0,placement:"right-start",referenceElement:k,content:I,children:D}),e[36]=k,e[37]=I,e[38]=D,e[39]=K):K=e[39];let L;return e[40]!==r||e[41]!==K?(L=p.jsx(aa,{setBoundaryElement:a,onDismiss:r,children:K}),e[40]=r,e[41]=K,e[42]=L):L=e[42],L};function Gr(t,e){try{const n=new URL(t,typeof location>"u"?void 0:location.origin);if(n.hash){const r=new URL(Gr(n.hash.slice(1),e));return`${n.origin}${n.pathname}${n.search}#${r.pathname}${r.search}`}return n.searchParams.set("preview",e),n.toString()}catch{return t}}const qr=g.createContext(null);function Pc(){const t=g.useContext(qr);if(!t)throw new Error("Preview Snapshots context is missing");return t}const $c=t=>g.isValidElement(t),Rc=ue(ht)`
  background-color: var(--overlay-bg);
  border-radius: 3px;
  pointer-events: none;
  position: absolute;
  will-change: transform;
  box-shadow: var(--overlay-box-shadow);
  transition: none;

  --overlay-bg: transparent;
  --overlay-box-shadow: inset 0 0 0 1px transparent;

  [data-overlays] & {
    --overlay-bg: color-mix(in srgb, transparent 95%, var(--card-focus-ring-color));
    --overlay-box-shadow: inset 0 0 0 2px
      color-mix(in srgb, transparent 50%, var(--card-focus-ring-color));
  }

  [data-fading-out] & {
    transition:
      box-shadow 1550ms,
      background-color 1550ms;

    --overlay-bg: rgba(0, 0, 255, 0);
    --overlay-box-shadow: inset 0 0 0 1px transparent;
  }

  &[data-focused] {
    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);
  }

  &[data-hovered]:not([data-focused]) {
    transition: none;
    --overlay-box-shadow: inset 0 0 0 2px var(--card-focus-ring-color);
  }

  /* [data-unmounted] & {
    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);
  } */

  :link {
    text-decoration: none;
  }
`,Ac=ue(Me)`
  bottom: 100%;
  cursor: pointer;
  pointer-events: none;
  position: absolute;
  right: 0;

  [data-hovered]:not([data-menu-open]) & {
    pointer-events: all;
  }

  [data-flipped] & {
    bottom: auto;
    top: 100%;
  }
`,Tc=ue(Me)`
  top: 100%;
  cursor: pointer;
  pointer-events: none;
  position: absolute;
  left: 0;

  gap: 4px;
  padding: 4px 0;
  flex-wrap: wrap;

  [data-hovered]:not([data-menu-open]) & {
    pointer-events: all;
  }

  [data-flipped] & {
    top: calc(100% + 2rem);
  }
`,Dc=ue(Me)`
  margin: -0.5rem;

  [data-hovered]:not([data-menu-open]) & {
    pointer-events: all;
  }
`,Oc=ue(Me)`
  bottom: 100%;
  cursor: pointer;
  pointer-events: none;
  position: absolute;
  left: 0;

  [data-hovered]:not([data-menu-open]) & {
    pointer-events: all;
  }

  [data-flipped] & {
    bottom: auto;
    top: 100%;
  }
`,Nc=ue(ht)`
  cursor: pointer;
  background-color: var(--card-focus-ring-color);
  right: 0;
  border-radius: 3px;

  & [data-ui='Text'] {
    color: #fff;
    white-space: nowrap;
  }
`,Lc=ue(Me)`
  display: flex;
  align-items: center;
  background-color: var(--card-focus-ring-color);
  right: 0;
  border-radius: 3px;
  & [data-ui='Text'],
  & [data-sanity-icon] {
    color: #fff;
    white-space: nowrap;
  }
`,Uc=ue.div`
  position: absolute;
  inset: 0;
  pointer-events: all;
`;function zc(t){const{id:e,type:n,path:r,baseUrl:o,tool:i,workspace:s,perspective:c}=t,[a,u]=To({baseUrl:o,workspace:s,tool:i,type:n,id:e,path:r?Is(Un.fromString(r)):[]}).split("?"),l=new URLSearchParams(u),f=c||l.get("perspective");return f==="drafts"?l.delete("perspective"):f&&l.set("perspective",f),`${a}?${l}`}const Fc=t=>{const e=q.c(60),{id:n,element:r,focused:o,componentResolver:i,node:s,showActions:c,draggable:a,targets:u,elementType:l,comlink:f,onActivateExclusivePlugin:d,onMenuOpenChange:y,inFrame:v}=t,{getField:m,getType:E}=Or();let M;e[0]!==E||e[1]!==s?(M=E(s),e[0]=E,e[1]=s,e[2]=M):M=e[2];const S=M;let $;e[3]!==s?($="path"in s?zc(s):s.href,e[3]=s,e[4]=$):$=e[4];const k=$,R=Pc();let A;e:{if(!("path"in s)){A=void 0;break e}let F;e[5]!==s||e[6]!==R?(F=R.find(Y=>Y._id===s.id)?.title,e[5]=s,e[6]=R,e[7]=F):F=e[7],A=F}const U=A;let C;e[8]!==r||e[9]!==o||e[10]!==m||e[11]!==E?(C=function(F,Y){const W=E(F),{field:ie,parent:B}=m(F);if(!("id"in F)||!ie||!W)return;const J=ie.value.type;return{document:W,element:r,targetElement:Y||r,field:ie,focused:!!o,node:F,parent:B,type:J}},e[8]=r,e[9]=o,e[10]=m,e[11]=E,e[12]=C):C=e[12];const N=C;let _;e[13]!==l||e[14]!==N||e[15]!==s?(_=l==="element"?N(s):void 0,e[13]=l,e[14]=N,e[15]=s,e[16]=_):_=e[16];let j;if(e[17]!==N||e[18]!==u){let F;e[20]!==N?(F=Y=>N(Y.sanity,Y.element),e[20]=N,e[21]=F):F=e[21],j=u.map(F).filter(Bc),e[17]=N,e[18]=u,e[19]=j}else j=e[19];let P;e[22]!==_||e[23]!==j?(P={legacyComponentContext:_,pluginContexts:j},e[22]=_,e[23]=j,e[24]=P):P=e[24];const I=P,z=Kc(I.legacyComponentContext,i),w=qc(I.pluginContexts,t.plugins);let D;e[25]!==S?(D=S?.icon?p.jsx("div",{dangerouslySetInnerHTML:{__html:S.icon}}):p.jsx(Mo,{}),e[25]=S,e[26]=D):D=e[26];const K=D,L=g.useId();let G;e[27]!==w?(G=w?.some(Hc),e[27]=w,e[28]=G):G=e[28];const V=G||w?.length>1;let H;e[29]!==n?(H=()=>{window.dispatchEvent(new CustomEvent("sanity-overlay/label-click",{detail:{id:n}}))},e[29]=n,e[30]=H):H=e[30];const X=H;let Z;e[31]!==k||e[32]!==v||e[33]!==c?(Z=c?p.jsx(Ac,{gap:1,paddingY:1,children:p.jsx(Wc,{inFrame:v,href:k})}):null,e[31]=k,e[32]=v,e[33]=c,e[34]=Z):Z=e[34];let Q;e[35]!==f||e[36]!==a||e[37]!==X||e[38]!==K||e[39]!==L||e[40]!==w||e[41]!==d||e[42]!==y||e[43]!==V||e[44]!==U?(Q=(U||V)&&p.jsx(Oc,{gap:1,paddingY:1,onClick:X,children:p.jsxs(Lc,{gap:2,padding:2,children:[a&&p.jsx(Oe,{marginRight:1,children:p.jsx(ge,{className:"drag-handle",size:0,children:p.jsx(jo,{})})}),p.jsx(ge,{size:0,children:K}),U&&p.jsx(ge,{size:1,weight:"medium",children:U}),V&&p.jsx(Oe,{paddingLeft:2,onClick:Yc,children:p.jsx(Dc,{children:p.jsx(Co,{id:L,popover:{animate:!0,placement:"bottom-start",constrainSize:!0,tone:"default"},onOpen:()=>{y?.(!0)},onClose:()=>{y?.(!1)},button:p.jsx(Po,{icon:$o,tone:"primary",padding:2}),menu:p.jsx(Gn,{paddingY:0,children:p.jsx(_t,{children:w?.map((F,Y)=>p.jsxs(g.Fragment,{children:[p.jsxs(qn,{role:"group",paddingY:1,space:0,children:[p.jsx(Lt,{paddingY:2,text:p.jsx(Oe,{paddingY:2,children:p.jsx(ge,{muted:!0,size:1,style:{textTransform:"capitalize"},children:`${F.context.document.name}: ${F.context.field?.name}`})}),onClick:()=>{F.context.node&&f?.post("visual-editing/focus",F.context.node)}}),F.exclusive.map(W=>W.component?p.jsx(Lt,{paddingY:2,icon:W.icon||p.jsx(_o,{}),text:p.jsx(Oe,{paddingY:2,children:p.jsx(ge,{size:1,children:W.title||W.name})}),onClick:()=>d?.(W,F.context)},W.name):null)]}),Y<w.length-1&&p.jsx(Vt,{})]},F.id))})})})})})]})}),e[35]=f,e[36]=a,e[37]=X,e[38]=K,e[39]=L,e[40]=w,e[41]=d,e[42]=y,e[43]=V,e[44]=U,e[45]=Q):Q=e[45];let h;e[46]!==w?(h=w?.map(Xc),e[46]=w,e[47]=h):h=e[47];let b;e[48]!==h?(b=p.jsx(Tc,{children:h}),e[48]=h,e[49]=b):b=e[49];let x;e[50]!==Z||e[51]!==Q||e[52]!==b?(x=p.jsxs(_t,{children:[Z,Q,b]}),e[50]=Z,e[51]=Q,e[52]=b,e[53]=x):x=e[53];let T;e[54]!==z||e[55]!==I.legacyComponentContext?(T=Array.isArray(z)?z.map((F,Y)=>{const{component:W,props:ie}=F;return p.jsx(W,{PointerEvents:_t,...I.legacyComponentContext,...ie},Y)}):z,e[54]=z,e[55]=I.legacyComponentContext,e[56]=T):T=e[56];let O;return e[57]!==x||e[58]!==T?(O=p.jsxs(p.Fragment,{children:[x,T]}),e[57]=x,e[58]=T,e[59]=O):O=e[59],O},Gc=g.memo(function(t){const e=q.c(39),{draggable:n,focused:r,hovered:o,rect:i,wasMaybeCollapsed:s,enableScrollIntoView:c,inFrame:a}=t,u=g.useRef(null),l=g.useRef(!1),f=`${i.w}px`,d=`${i.h}px`,y=`translate(${i.x}px, ${i.y}px)`;let v;e[0]!==f||e[1]!==d||e[2]!==y?(v={width:f,height:d,transform:y},e[0]=f,e[1]=d,e[2]=y,e[3]=v):v=e[3];const m=v;let E,M;e[4]!==c||e[5]!==r||e[6]!==s?(E=()=>{if(!l.current&&!s&&r===!0&&u.current&&c){const x=u.current;Do(u.current,{behavior:T=>{T.length!==0&&x.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},scrollMode:"if-needed",block:"center",inline:"nearest"})}l.current=r===!0},M=[r,s,c],e[4]=c,e[5]=r,e[6]=s,e[7]=E,e[8]=M):(E=e[7],M=e[8]),g.useEffect(E,M);const[S,$]=g.useState(!1);let k;e[9]!==o?(k=()=>{if(!u.current||!o)return;const x=new IntersectionObserver(T=>{const[O]=T;$(O.boundingClientRect.top<0)},{threshold:1});return x.observe(u.current),()=>x.disconnect()},e[9]=o,e[10]=k):k=e[10];let R;e[11]!==o||e[12]!==S?(R=[o,S],e[11]=o,e[12]=S,e[13]=R):R=e[13],g.useEffect(k,R);const[A,U]=g.useState(null);let C;e[14]===Symbol.for("react.memo_cache_sentinel")?(C=()=>{U(null),window.dispatchEvent(new CustomEvent("sanity-overlay/exclusive-plugin-closed"))},e[14]=C):C=e[14];const N=C;let _;e[15]===Symbol.for("react.memo_cache_sentinel")?(_=(x,T)=>{U({plugin:x,context:T})},e[15]=_):_=e[15];const j=_,P=Jc,I=A?.plugin.component,[z,w]=g.useState(!1);let D;e[16]===Symbol.for("react.memo_cache_sentinel")?(D=()=>{g.startTransition(()=>w(!1))},e[16]=D):D=e[16];let K;e[17]!==o?(K=[o],e[17]=o,e[18]=K):K=e[18],g.useEffect(D,K);let L;e[19]!==I||e[20]!==z?(L=z||I?p.jsx(Sr,{onDismiss:N,blockScroll:z}):null,e[19]=I,e[20]=z,e[21]=L):L=e[21];const G=r?"":void 0,V=o?"":void 0,H=S?"":void 0,X=n?"":void 0,Z=z?"":void 0;let Q;e[22]!==I||e[23]!==A||e[24]!==o||e[25]!==a||e[26]!==t?(Q=I?p.jsx(Uc,{"data-sanity-overlay-element":!0,onClick:P,children:p.jsx(I,{...A.context,closeExclusiveView:N})}):o?p.jsx(Fc,{...t,inFrame:a,onActivateExclusivePlugin:j,onMenuOpenChange:w}):null,e[22]=I,e[23]=A,e[24]=o,e[25]=a,e[26]=t,e[27]=Q):Q=e[27];let h;e[28]!==m||e[29]!==G||e[30]!==V||e[31]!==H||e[32]!==X||e[33]!==Z||e[34]!==Q?(h=p.jsx(Rc,{"data-focused":G,"data-hovered":V,"data-flipped":H,"data-draggable":X,"data-menu-open":Z,ref:u,style:m,children:Q}),e[28]=m,e[29]=G,e[30]=V,e[31]=H,e[32]=X,e[33]=Z,e[34]=Q,e[35]=h):h=e[35];let b;return e[36]!==L||e[37]!==h?(b=p.jsxs(p.Fragment,{children:[L,h]}),e[36]=L,e[37]=h,e[38]=b):b=e[38],b});function qc(t,e){const n=q.c(5);let r;if(n[0]!==t||n[1]!==e){let o;n[3]!==e?(o=i=>{const s={id:vr(),context:i,hud:[],exclusive:[]};return e?.forEach(c=>{c.guard?.(i)&&(c.type==="hud"&&s.hud.push(c),c.type==="exclusive"&&s.exclusive.push(c))}),s},n[3]=e,n[4]=o):o=n[4],r=t.map(o),n[0]=t,n[1]=e,n[2]=r}else r=n[2];return r}function Kc(t,e){const n=q.c(3);let r;if(n[0]!==t||n[1]!==e){e:{if(!t){r=void 0;break e}const o=e?.(t);if(!o){r=void 0;break e}if($c(o)){r=o;break e}r=(Array.isArray(o)?o:[o]).map(Vc)}n[0]=t,n[1]=e,n[2]=r}else r=n[2];return r}function Vc(t){return typeof t=="object"&&"component"in t?t:{component:t,props:{}}}const Wc=g.memo(function(t){const e=q.c(8),{inFrame:n}=t,r=g.useSyncExternalStore(Zc,Qc);let o;e[0]!==t.href||e[1]!==r?(o=Gr(t.href,r),e[0]=t.href,e[1]=r,e[2]=o):o=e[2];const i=o,s=n?void 0:"_blank",c=n?"noopener":"noopener noreferrer";let a;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=p.jsx(Nc,{padding:2,children:p.jsx(ge,{size:1,weight:"medium",children:"Open in Studio"})}),e[3]=a):a=e[3];let u;return e[4]!==i||e[5]!==s||e[6]!==c?(u=p.jsx(Oe,{as:"a",href:i,target:s,rel:c,children:a}),e[4]=i,e[5]=s,e[6]=c,e[7]=u):u=e[7],u});function Bc(t){return t!==void 0}function Hc(t){return t.exclusive.length>0}function Yc(t){t.stopPropagation()}function Xc(t){return p.jsx(g.Fragment,{children:t.hud.map(e=>{const n=e.component;return n?p.jsx(n,{...t.context},e.name):null})},t.id)}function Jc(t){t.stopPropagation()}function Zc(t){const e=()=>t();return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}function Qc(){return window.location.href}const eu=t=>{const e=q.c(5),{dragGroupRect:n}=t,r=`${n.y}px`,o=`${n.x}px`,i=`${n.w-1}px`,s=`${n.h-1}px`;let c;return e[0]!==r||e[1]!==o||e[2]!==i||e[3]!==s?(c=p.jsx("div",{style:{position:"absolute",top:r,left:o,width:i,height:s,border:"1px dashed #f0709b",pointerEvents:"none"}}),e[0]=r,e[1]=o,e[2]=i,e[3]=s,e[4]=c):c=e[4],c},fe=6;function Tn(t,e,n){return t*(1-n)+e*n}const tu=t=>{const e=q.c(4),{dragInsertPosition:n}=t;if(n===null)return;const r=n?.left||n?.right?"horizontal":"vertical";let o=0,i=0,s=0,c=0;if(r==="horizontal"){const{left:d,right:y}=n;if(s=fe,y&&d){const v=d.rect.x+d.rect.w,m=y.rect.x,E=Math.min(y.rect.h,d.rect.h)*.0125;o=Tn(v,m,.5)-fe/2,i=d.rect.y+E,c=Math.min(y.rect.h,d.rect.h)-E*2}else if(y&&!d){const v=y.rect.h*.0125;o=y.rect.x-fe/2,i=y.rect.y+v,c=y.rect.h-v*2}else if(d&&!y){const v=d.rect.h*.0125;o=d.rect.x+d.rect.w-fe/2,i=d.rect.y+v,c=d.rect.h-v*2}}else{const{bottom:d,top:y}=n;if(d&&y){const v=Math.min(y.rect.x,d.rect.x),m=y.rect.y+y.rect.h,E=d.rect.y,M=Math.min(d.rect.w,y.rect.w)*.0125;c=fe,o=v+M,i=Tn(m,E,.5)-fe/2,s=Math.max(d.rect.w,y.rect.w)-M*2}else if(d&&!y){const v=d.rect.w*.0125;o=d.rect.x+v,i=d.rect.y-fe/2,s=d.rect.w-v*2,c=fe}else if(y&&!d){const v=y.rect.w*.0125;o=y.rect.x+v,i=y.rect.y+y.rect.h-fe/2,s=y.rect.w-v*2,c=fe}}const a=`${s}px`,u=`${c}px`,l=`translate(${o}px, ${i}px)`;let f;return e[0]!==a||e[1]!==u||e[2]!==l?(f=p.jsx("div",{style:{position:"absolute",width:a,height:u,transform:l,background:"#556bfc",border:"2px solid white",borderRadius:"999px",zIndex:"999999"}}),e[0]=a,e[1]=u,e[2]=l,e[3]=f):f=e[3],f},nu=ue.div`
  --drag-preview-opacity: 0.98;
  --drag-preview-skeleton-stroke: #ffffff;

  @media (prefers-color-scheme: dark) {
    --drag-preview-skeleton-stroke: #383d51;
  }

  position: fixed;
  display: grid;
  transform: ${({$scaleFactor:t,$width:e,$height:n})=>`translate(calc(var(--drag-preview-x) - ${e/2}px), calc(var(--drag-preview-y) - ${n/2}px)) scale(${t})`};
  width: ${({$width:t})=>`${t}px`};
  height: ${({$height:t})=>`${t}px`};
  z-index: 9999999;
  opacity: var(--drag-preview-opacity);
  cursor: move;

  .drag-preview-content-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
    container-type: inline-size;
  }

  [data-ui='card'] {
    position: relative;
    width: 100%;
    height: 100%;
  }

  .drag-preview-skeleton {
    position: absolute;
    inset: 0;

    rect {
      stroke: var(--drag-preview-skeleton-stroke);
    }
  }

  .drag-preview-handle {
    position: absolute;
    top: 4cqmin;
    left: 4cqmin;
    width: 6cqmin;
    fill: var(--drag-preview-handle-fill);
  }
`;function ru(t,e,n){return t<e?e:t>n?n:t}function ou(t,e,n,r,o){const i=(t-e)*(o-r)/(n-e)+r;return ru(i,r,o)}const iu=t=>{const e=q.c(50),{skeleton:n}=t,r=Math.min(n.maxWidth,window.innerWidth/2),o=n.w>r?r/n.w:1,i=n.offsetX*o,s=n.offsetY*o,c=Kn(),a=Wo(),u=a.radius[~~ou(n.w,0,1920,1,a.radius.length-2)];let l,f,d,y,v,m,E,M,S,$,k,R,A,U,C,N;if(e[0]!==i||e[1]!==s||e[2]!==c||e[3]!==u||e[4]!==o||e[5]!==n.childRects||e[6]!==n.h||e[7]!==n.w){const w=n.childRects.filter(su),D=n.childRects.filter(au);f=nu,y=n.w,v=n.h,m=i,E=s,M=o,l=ht,R=u,A=4,U="hidden",C="transparent",N=c?"dark":"light",k="drag-preview-content-wrapper",S="drag-preview-skeleton",$=`0 0 ${n.w} ${n.h}`,d=[...w,...D],e[0]=i,e[1]=s,e[2]=c,e[3]=u,e[4]=o,e[5]=n.childRects,e[6]=n.h,e[7]=n.w,e[8]=l,e[9]=f,e[10]=d,e[11]=y,e[12]=v,e[13]=m,e[14]=E,e[15]=M,e[16]=S,e[17]=$,e[18]=k,e[19]=R,e[20]=A,e[21]=U,e[22]=C,e[23]=N}else l=e[8],f=e[9],d=e[10],y=e[11],v=e[12],m=e[13],E=e[14],M=e[15],S=e[16],$=e[17],k=e[18],R=e[19],A=e[20],U=e[21],C=e[22],N=e[23];let _;e[24]!==d||e[25]!==a.color?(_=d.map((w,D)=>p.jsx("rect",{x:w.x,y:w.y,width:w.w,height:w.h,fill:a.color.skeleton.from},D)),e[24]=d,e[25]=a.color,e[26]=_):_=e[26];let j;e[27]!==_||e[28]!==S||e[29]!==$?(j=p.jsx("svg",{className:S,viewBox:$,children:_}),e[27]=_,e[28]=S,e[29]=$,e[30]=j):j=e[30];let P;e[31]!==j||e[32]!==k?(P=p.jsx("div",{className:k,children:j}),e[31]=j,e[32]=k,e[33]=P):P=e[33];let I;e[34]!==l||e[35]!==P||e[36]!==R||e[37]!==A||e[38]!==U||e[39]!==C||e[40]!==N?(I=p.jsx(l,{radius:R,shadow:A,overflow:U,tone:C,scheme:N,children:P}),e[34]=l,e[35]=P,e[36]=R,e[37]=A,e[38]=U,e[39]=C,e[40]=N,e[41]=I):I=e[41];let z;return e[42]!==f||e[43]!==y||e[44]!==v||e[45]!==m||e[46]!==E||e[47]!==M||e[48]!==I?(z=p.jsx(f,{$width:y,$height:v,$offsetX:m,$offsetY:E,$scaleFactor:M,children:I}),e[42]=f,e[43]=y,e[44]=v,e[45]=m,e[46]=E,e[47]=M,e[48]=I,e[49]=z):z=e[49],z};function su(t){return t.tagName==="IMG"}function au(t){return t.tagName!=="IMG"}const cu=ue(ht)`
  position: fixed;
  bottom: 2rem;
  left: 2rem;
`,uu=()=>{const t=q.c(2);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e={zIndex:"999999"},t[0]=e):e=t[0];let n;return t[1]===Symbol.for("react.memo_cache_sentinel")?(n=p.jsx(cu,{padding:2,shadow:2,radius:2,style:e,children:p.jsxs(Me,{align:"center",gap:2,children:[p.jsx(Ko,{keys:["Shift"]}),p.jsx(ge,{size:1,children:"Zoom Out"}),p.jsx(Vo,{})]})}),t[1]=n):n=t[1],n},lu=(t,e)=>{const{type:n}=e;switch(n){case"element/register":return t.find(r=>r.id===e.id)?t:[...t,{id:e.id,activated:!1,element:e.element,focused:!1,hovered:!1,rect:e.rect,sanity:e.sanity,dragDisabled:e.dragDisabled,targets:e.targets,elementType:e.elementType}];case"element/activate":return t.map(r=>r.id===e.id?{...r,activated:!0}:r);case"element/update":return t.map(r=>r.id===e.id?{...r,sanity:e.sanity,rect:e.rect,targets:e.targets,elementType:e.elementType}:r);case"element/unregister":return t.filter(r=>r.id!==e.id);case"element/deactivate":return t.map(r=>r.id===e.id?{...r,activated:!1,hovered:!1}:r);case"element/mouseenter":return t.map(r=>r.id===e.id?{...r,rect:e.rect,hovered:!0}:{...r,hovered:!1});case"element/mouseleave":return t.map(r=>r.id===e.id?{...r,hovered:!1}:r);case"element/updateRect":return t.map(r=>r.id===e.id?{...r,rect:e.rect}:r);case"element/click":return t.map(r=>({...r,focused:r.id===e.id&&"clicked"}));case"overlay/reset-mouse-state":return t.map(r=>({...r,focused:!1,hovered:!1}));case"overlay/blur":return t.map(r=>({...r,focused:!1}));case"presentation/blur":return t.map(r=>({...r,focused:!1}));case"presentation/focus":{const r=t.find(o=>o.focused==="clicked");return t.map(o=>{const i="path"in o.sanity&&o.sanity.id===e.data.id&&o.sanity.path===e.data.path;return r&&o===r&&i?o:{...o,focused:i&&r?"duplicate":i}})}default:return t}};function du(t,e){const{type:n}=e;let{contextMenu:r,focusPath:o,perspective:i,isDragging:s,dragInsertPosition:c,dragShowMinimap:a,dragShowMinimapPrompt:u,dragSkeleton:l,dragMinimapTransition:f,dragGroupRect:d}=t,y=!1;if(n==="presentation/focus"){const v=t.focusPath;o=e.data.path,v!==o&&(y=v.slice(o.length).startsWith("["))}return n==="presentation/perspective"&&(i=e.data.perspective),n==="element/contextmenu"&&("sanity"in e?r={node:e.sanity,position:e.position}:r=null),(n==="element/click"||n==="element/mouseleave"||n==="overlay/blur"||n==="presentation/blur"||n==="presentation/focus")&&(r=null),n==="overlay/dragUpdateInsertPosition"&&(c=e.insertPosition),n==="overlay/dragStart"&&(s=!0),e.type==="overlay/dragUpdateSkeleton"&&(l=e.skeleton),n==="overlay/dragEnd"&&(s=!1),e.type==="overlay/dragToggleMinimapPrompt"&&(u=e.display),n==="overlay/dragStartMinimapTransition"&&(f=!0),n==="overlay/dragEndMinimapTransition"&&(f=!1),n==="overlay/dragUpdateGroupRect"&&(d=e.groupRect),n==="overlay/dragToggleMinimap"&&(a=e.display),{...t,contextMenu:r,elements:lu(t.elements,e),dragInsertPosition:c,dragSkeleton:l,dragGroupRect:d,isDragging:s,focusPath:o,perspective:i,wasMaybeCollapsed:y,dragShowMinimap:a,dragShowMinimapPrompt:u,dragMinimapTransition:f}}const pu=function(t){const e=q.c(13),{comlink:n,children:r}=t;let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],e[0]=o):o=e[0];const[i,s]=g.useState(o);let c;e[1]!==n?(c=async m=>{if(n)try{const E=await n.fetch("visual-editing/preview-snapshots",void 0,{signal:m,suppressWarnings:!0});s(E.snapshots)}catch{}},e[1]=n,e[2]=c):c=e[2];const a=c;let u,l;e[3]!==n||e[4]!==a?(u=()=>{if(!n)return;const m=new AbortController,E=n.onStatus(()=>{a(m.signal)},"connected");return()=>{m.abort(),E()}},l=[n,a],e[3]=n,e[4]=a,e[5]=u,e[6]=l):(u=e[5],l=e[6]),g.useEffect(u,l);let f,d;e[7]!==n?(f=()=>n?.on("presentation/preview-snapshots",m=>{s(m.snapshots)}),d=[n],e[7]=n,e[8]=f,e[9]=d):(f=e[8],d=e[9]),g.useEffect(f,d);const y=i;let v;return e[10]!==r||e[11]!==y?(v=p.jsx(qr.Provider,{value:y,children:r}),e[10]=r,e[11]=y,e[12]=v):v=e[12],v};function Dn(t){return"path"in t}function fu(t){return t.type==="document"}function mu(t){return t.type==="type"}function yu(t){return t.split(".").toReversed().reduce((e,n)=>e.length?[n,...e]:n.includes("[_key==")?[n]:[],[]).join(".")}function hu(t){return t.reduce((e,n)=>{const{sanity:r}=n;if(!("id"in r)||!r.path.includes("[_key=="))return e;const o=yu(r.path);return e.find(i=>i.id===r.id&&i.path===o)||e.push({id:r.id,path:o}),e},[])}const gu=function(t){const e=q.c(22),{comlink:n,children:r,elements:o}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=new Map,e[0]=i):i=e[0];const[s,c]=g.useState(i),[a,u]=g.useState(null);let l,f;e[1]!==n?(l=()=>{if(!n)return;const j=async function(z){if(n)try{const w=await n.fetch("visual-editing/schema",void 0,{signal:z,suppressWarnings:!0});u(w.schema)}catch{}},P=new AbortController,I=n.onStatus(()=>{j(P.signal)},"connected");return()=>{P.abort(),I()}},f=[n],e[1]=n,e[2]=l,e[3]=f):(l=e[2],f=e[3]),g.useEffect(l,f);let d;e[4]===Symbol.for("react.memo_cache_sentinel")?(d=[],e[4]=d):d=e[4];const y=g.useRef(d),v=g.useDeferredValue(o);let m;e[5]!==v?(m=hu(v),e[5]=v,e[6]=m):m=e[6];const E=m,M=g.useRef(null);let S,$;e[7]!==n||e[8]!==E?(S=()=>{if(!E.length||!n)return;const j=async(P,I)=>{const z=y.current;try{y.current=P;const w=await n.fetch("visual-editing/schema-union-types",{paths:P},{signal:I,suppressWarnings:!0});if(I.aborted)return;c(w.types),M.current=null}catch{}I.aborted&&(y.current=z)};E.some(P=>!y.current.find(I=>{const{id:z,path:w}=I;return z===P.id&&w===P.path}))&&(M.current?.abort(),M.current=new AbortController,j(E,M.current.signal))},$=[n,E],e[7]=n,e[8]=E,e[9]=S,e[10]=$):(S=e[9],$=e[10]),g.useEffect(S,$);let k;e[11]!==a?(k=(j,P)=>{const I=P||"document";if(!a||typeof j!="string"&&(!Dn(j)||!Array.isArray(a)))return;const z=typeof j=="string"?j:j.type,w=I==="document"?fu:mu;return a.filter(w).find(D=>D.name===z)},e[11]=a,e[12]=k):k=e[12];const R=k;let A;e[13]!==R||e[14]!==s?(A=j=>{if(!Dn(j))return{field:void 0,parent:void 0};const P=R(j);if(!P)return{field:void 0,parent:void 0};function I(w,D,K,L){const G=L===void 0?[]:L;if(!w)return{field:void 0,parent:void 0};const[V,...H]=D;if("fields"in w){const X=w.fields[V];if(!X&&"rest"in w)return I(w.rest,D,w,G);if(!H.length)return{field:X,parent:K};if(!X)throw new Error(`[@sanity/visual-editing] No field could be resolved at path: "${[...G,...D].join(".")}"`);return I(X.value,H,w,[...G,V])}else{if(w.type==="array")return I(w.of,D,w,G);if(w.type==="arrayItem")return H.length?I(w.value,H,w,[...G,V]):{field:w,parent:K};if(w.type==="union"){const X=V.startsWith("[_key==")?s?.get(j.id)?.get([G.join("."),V].filter(Boolean).join("")):V;return I(w.of.find(Z=>Z.type==="unionOption"?Z.name===X:Z),H,w,[...G,V])}else{if(w.type==="unionOption")return V?I(w.value,D,w,G):{field:w,parent:K};if(w.type==="inline"){const X=R(w.name,"type");return I(X.value,D,w,G)}}}throw new Error(`[@sanity/visual-editing] No field could be resolved at path: "${[...G,...D].join(".")}"`)}const z=j.path.split(".").flatMap(vu);try{return I(P,z,void 0)}catch(w){const D=w;return D instanceof Error&&console.warn(D.message),{field:void 0,parent:void 0}}},e[13]=R,e[14]=s,e[15]=A):A=e[15];const U=A;let C;e[16]!==U||e[17]!==R?(C={getField:U,getType:R},e[16]=U,e[17]=R,e[18]=C):C=e[18];const N=C;let _;return e[19]!==r||e[20]!==N?(_=p.jsx(Dr.Provider,{value:N,children:r}),e[19]=r,e[20]=N,e[21]=_):_=e[21],_};function vu(t){return t.includes("[")?t.split(/(\[.+\])/,2):[t]}const wu=t=>{let e=t;const n=()=>e,r=new Set;return{getState:n,setState:o=>{e=o(e),r.forEach(i=>i())},subscribe:o=>(r.add(o),()=>r.delete(o))}},yt=wu({}),bu=t=>{const e=q.c(11),{comlink:n,children:r}=t;let o,i;e[0]!==n?(o=()=>n?.on("presentation/shared-state",xu),i=[n],e[0]=n,e[1]=o,e[2]=i):(o=e[1],i=e[2]),g.useEffect(o,i);let s,c;e[3]!==n?(s=()=>{(async function(){const f=await n?.fetch("visual-editing/shared-state",void 0,{suppressWarnings:!0});f&&yt.setState(()=>f.state)})().catch(Eu)},c=[n],e[3]=n,e[4]=s,e[5]=c):(s=e[4],c=e[5]),g.useEffect(s,c);let a;e[6]!==n?(a={comlink:n,store:yt},e[6]=n,e[7]=a):a=e[7];const u=a;let l;return e[8]!==r||e[9]!==u?(l=p.jsx(ra.Provider,{value:u,children:r}),e[8]=r,e[9]=u,e[10]=l):l=e[10],l};function xu(t){"value"in t?yt.setState(e=>({...e,[t.key]:t.value})):yt.setState(e=>Object.fromEntries(Object.entries(e).filter(n=>{const[r]=n;return r!==t.key})))}function Eu(t){console.debug(t),console.warn("[@sanity/visual-editing]: Failed to fetch shared state. Check your version of `sanity` is up-to-date")}const Iu=t=>{const e=q.c(5),{children:n,comlink:r}=t;let o;e[0]!==r?(o=(c,a)=>{if(!r)return;const u=ua[c];if(u)r.post("visual-editing/telemetry-log",{event:u,data:a});else throw new Error(`Telemetry event: ${c} does not exist`)},e[0]=r,e[1]=o):o=e[1];const i=o;let s;return e[2]!==n||e[3]!==i?(s=p.jsx(kr.Provider,{value:i,children:n}),e[2]=n,e[3]=i,e[4]=s):s=e[4],s};function Su(t,e,n,r){const o=q.c(7),i=g.useRef(void 0),s=cr();let c,a;return o[0]!==t||o[1]!==e||o[2]!==n||o[3]!==r||o[4]!==s?(c=()=>{if(t)return i.current=na({handler:e,overlayElement:t,inFrame:n,inPopUp:r,optimisticActorReady:s}),()=>{i.current?.destroy(),i.current=void 0}},a=[t,e,n,r,s],o[0]=t,o[1]=e,o[2]=n,o[3]=r,o[4]=s,o[5]=c,o[6]=a):(c=o[5],a=o[6]),g.useEffect(c,a),i}function ku(t,e){const n=q.c(4);let r,o;n[0]!==t||n[1]!==e?(r=()=>{const i=new AbortController;t?.fetch("visual-editing/fetch-perspective",void 0,{signal:i.signal,suppressWarnings:!0}).then(c=>{e({type:"presentation/perspective",data:c})}).catch(Mu);const s=t?.on("presentation/perspective",c=>{e({type:"presentation/perspective",data:c})});return()=>{s?.(),i.abort()}},o=[t,e],n[0]=t,n[1]=e,n[2]=r,n[3]=o):(r=n[2],o=n[3]),g.useEffect(r,o)}function Mu(){}function ju(t,e){if(t===e)return!0;if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function Cu(t,e,n){const r=q.c(7),o=g.useRef(void 0);let i;r[0]!==t?(i=(u,l)=>{t?.post("visual-editing/documents",{documents:u,perspective:l})},r[0]=t,r[1]=i):i=r[1];const s=i;let c,a;r[2]!==e||r[3]!==n||r[4]!==s?(c=()=>{const u=e.map($u).filter(Pu),l=new Set(u.map(_u));if(!o.current||!ju(l,o.current.nodeIds)||n!==o.current.perspective){const f=Array.from(l).map(d=>{const y=u.find(M=>M.id===d),{type:v,projectId:m,dataset:E}=y;return m&&E?{_id:d,_type:v,_projectId:m,_dataset:E}:{_id:d,_type:v}});o.current={nodeIds:l,perspective:n},s(f,n)}},a=[e,n,s],r[2]=e,r[3]=n,r[4]=s,r[5]=c,r[6]=a):(c=r[5],a=r[6]),g.useEffect(c,a)}function _u(t){return t.id}function Pu(t){return!!t}function $u(t){const{sanity:e}=t;return!e||!("id"in e)?null:e}const Ru=ue.div`
  background-color: transparent;
  direction: ltr;
  inset: 0;
  pointer-events: none;
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: ${({$zIndex:t})=>t??"9999999"};
`;function On(t){let e,n;return e=requestAnimationFrame(()=>{n=requestAnimationFrame(t)}),()=>{e!==void 0&&cancelAnimationFrame(e),n!==void 0&&cancelAnimationFrame(n)}}const Au=t=>{const e=q.c(8),{documentIds:n}=t;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=[],e[0]=r):r=e[0];const[o,i]=g.useState(r);let s,c;e[1]!==n?(s=()=>{g.startTransition(()=>i(f=>{const d=Array.from(new Set(n));return f.length===d.length&&f.reduce(Bu,d)?.length===0?f:d}))},c=[n],e[1]=n,e[2]=s,e[3]=c):(s=e[2],c=e[3]),g.useEffect(s,c);const a=Yt();let u,l;return e[4]!==a||e[5]!==o?(u=()=>{for(const f of o)a.send({type:"observe",documentId:Tt(f)}),a.send({type:"observe",documentId:Dt(f)});return()=>{for(const f of o)a.send({type:"unobserve",documentId:Tt(f)}),a.send({type:"unobserve",documentId:Dt(f)})}},l=[a,o],e[4]=a,e[5]=o,e[6]=u,e[7]=l):(u=e[6],l=e[7]),g.useEffect(u,l),null},Tu=t=>{const e=q.c(12),{comlink:n,dispatch:r,inFrame:o,inPopUp:i,onDrag:s,overlayEnabled:c,rootElement:a}=t,{dispatchDragEndEvent:u}=Ec(),l=Mr();let f;e[0]!==n||e[1]!==r||e[2]!==u||e[3]!==s||e[4]!==l?(f=m=>{if(m.type==="element/click"){const{sanity:E}=m;n?.post("visual-editing/focus",E),l("Visual Editing Overlay Clicked",null)}else if(m.type==="overlay/activate")n?.post("visual-editing/toggle",{enabled:!0});else if(m.type==="overlay/deactivate")n?.post("visual-editing/toggle",{enabled:!1});else if(m.type==="overlay/dragEnd"){const{insertPosition:E,target:M,dragGroup:S,flow:$,preventInsertDefault:k}=m;u({insertPosition:E,target:M,dragGroup:S,flow:$,preventInsertDefault:k}),E&&l("Visual Editing Drag Sequence Completed",null)}else if(m.type==="overlay/dragUpdateCursorPosition"){s(m.x,m.y);return}else if(m.type==="overlay/dragToggleMinimap"&&m.display===!0)l("Visual Editing Drag Minimap Enabled",null);else if(m.type==="overlay/setCursor"){const{element:E,cursor:M}=m;M?E.style.cursor=M:E.style.removeProperty("cursor")}r(m)},e[0]=n,e[1]=r,e[2]=u,e[3]=s,e[4]=l,e[5]=f):f=e[5];const d=Su(a,f,o,i);let y;e[6]!==d.current||e[7]!==c?(y=()=>{c?d.current?.activate():d.current?.deactivate()},e[6]=d.current,e[7]=c,e[8]=y):y=e[8];let v;return e[9]!==d||e[10]!==c?(v=[d,c],e[9]=d,e[10]=c,e[11]=v):v=e[11],g.useEffect(y,v),null};function Du(t){const e=q.c(81),{comlink:n,comlinkStatus:r,componentResolver:o,inFrame:i,inPopUp:s,zIndex:c,onPerspectiveChange:a}=t,u=Kn();let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={contextMenu:null,dragInsertPosition:null,dragShowMinimap:!1,dragShowMinimapPrompt:!1,dragSkeleton:null,elements:[],focusPath:"",isDragging:!1,perspective:"published",wasMaybeCollapsed:!1,dragMinimapTransition:!1,dragGroupRect:null},e[0]=l):l=e[0];const[f,d]=g.useReducer(du,l),{contextMenu:y,dragInsertPosition:v,dragShowMinimap:m,dragShowMinimapPrompt:E,dragSkeleton:M,elements:S,isDragging:$,perspective:k,wasMaybeCollapsed:R,dragMinimapTransition:A,dragGroupRect:U}=f,[C,N]=g.useState(null),[_,j]=g.useState(!0);let P,I;e[1]!==n?(P=()=>{const ae=[n?.on("presentation/focus",ee=>{d({type:"presentation/focus",data:ee})}),n?.on("presentation/blur",ee=>{d({type:"presentation/blur",data:ee})}),n?.on("presentation/toggle-overlay",()=>{j(Ku)})].filter(Boolean);return()=>ae.forEach(qu)},I=[n],e[1]=n,e[2]=P,e[3]=I):(P=e[2],I=e[3]),g.useEffect(P,I),ku(n,d);let z,w;e[4]!==a||e[5]!==k?(z=()=>{if(!a)return;const ae=requestAnimationFrame(()=>g.startTransition(()=>a(k)));return()=>cancelAnimationFrame(ae)},w=[a,k],e[4]=a,e[5]=k,e[6]=z,e[7]=w):(z=e[6],w=e[7]),g.useEffect(z,w),Cu(n,S,k);let D;e[8]!==C?(D=(ae,ee)=>{C&&(C.style.setProperty("--drag-preview-x",`${ae}px`),C.style.setProperty("--drag-preview-y",`${ee-window.scrollY}px`))},e[8]=C,e[9]=D):D=e[9];const K=D;let L,G;e[10]===Symbol.for("react.memo_cache_sentinel")?(L=()=>{const ae=Gu;let ee=!1;const Ge=ye=>{Ln(ye)&&ee&&(ee=!1,j(Fu))},qe=ye=>{if(Ln(ye)){if(ye.ctrlKey||ye.metaKey||ye.shiftKey)return;ee||(ee=!0,j(zu))}Wu(["mod","\\"],ye)&&j(Uu)},Ke=()=>{ee&&(ee=!1,j(Lu))};return window.addEventListener("click",ae),window.addEventListener("keydown",qe),window.addEventListener("keyup",Ge),window.addEventListener("blur",Ke),()=>{window.removeEventListener("click",ae),window.removeEventListener("keydown",qe),window.removeEventListener("keyup",Ge),window.removeEventListener("blur",Ke)}},G=[j],e[10]=L,e[11]=G):(L=e[10],G=e[11]),g.useEffect(L,G);const[V,H]=g.useState(!1),[X,Z]=g.useState(!1),Q=g.useRef(void 0);let h,b;e[12]!==_?(b=()=>{if(_)return On(()=>{H(!0),On(()=>{Z(!0),Q.current=setTimeout(()=>{Z(!1),H(!1)},1500)})});Q.current&&(clearTimeout(Q.current),g.startTransition(()=>{H(!1),Z(!1)}))},h=[_],e[12]=_,e[13]=h,e[14]=b):(h=e[13],b=e[14]),g.useEffect(b,h);let x;e[15]!==S?(x=S.flatMap(Nu),e[15]=S,e[16]=x):x=e[16];const T=x;let O;e[17]===Symbol.for("react.memo_cache_sentinel")?(O=()=>{d({type:"overlay/blur"})},e[17]=O):O=e[17];const F=O,Y=cr(),W=Y?o:void 0,[ie,B]=g.useState(!1);!ie&&i&&r==="connected"&&B(!0);let J;e:{if($){let ee;e[18]===Symbol.for("react.memo_cache_sentinel")?(ee=[],e[18]=ee):ee=e[18],J=ee;break e}let ae;e[19]!==n||e[20]!==W||e[21]!==A||e[22]!==m||e[23]!==S||e[24]!==i||e[25]!==$||e[26]!==Y||e[27]!==t.plugins||e[28]!==ie||e[29]!==R?(ae=S.filter(Ou).map(ee=>{const{id:Ge,element:qe,focused:Ke,hovered:ye,rect:Vr,sanity:nt,dragDisabled:Wr,targets:Br,elementType:Hr}=ee,Yr=!Wr&&!!qe.getAttribute("data-sanity")&&Y&&S.some(bt=>"id"in bt.sanity&&"id"in nt?Ir(bt.sanity,nt)&&bt.sanity.path!==nt.path:!1);return p.jsx(Gc,{comlink:n,componentResolver:W,plugins:t.plugins,element:qe,enableScrollIntoView:!$&&!A&&!m,id:Ge,focused:Ke,hovered:ye,node:nt,rect:Vr,showActions:!ie,draggable:Yr,isDragging:$||A,wasMaybeCollapsed:Ke&&R,targets:Br,elementType:Hr,inFrame:i},Ge)}),e[19]=n,e[20]=W,e[21]=A,e[22]=m,e[23]=S,e[24]=i,e[25]=$,e[26]=Y,e[27]=t.plugins,e[28]=ie,e[29]=R,e[30]=ae):ae=e[30],J=ae}const le=J,ze=u?"dark":"light",Se=X?"":void 0,Fe=V?"":void 0;let re;e[31]!==T||e[32]!==k?(re=p.jsx(Au,{documentIds:T,perspective:k}),e[31]=T,e[32]=k,e[33]=re):re=e[33];let se;e[34]!==n||e[35]!==i||e[36]!==s||e[37]!==_||e[38]!==C||e[39]!==K?(se=p.jsx(Tu,{comlink:n,dispatch:d,inFrame:i,inPopUp:s,onDrag:K,overlayEnabled:_,rootElement:C}),e[34]=n,e[35]=i,e[36]=s,e[37]=_,e[38]=C,e[39]=K,e[40]=se):se=e[40];let we;e[41]!==y?(we=y&&p.jsx(_c,{...y,onDismiss:F}),e[41]=y,e[42]=we):we=e[42];let de;e[43]!==U||e[44]!==v||e[45]!==A||e[46]!==E||e[47]!==$?(de=$&&!A&&p.jsxs(p.Fragment,{children:[v&&p.jsx(tu,{dragInsertPosition:v}),E&&p.jsx(uu,{}),U&&p.jsx(eu,{dragGroupRect:U})]}),e[43]=U,e[44]=v,e[45]=A,e[46]=E,e[47]=$,e[48]=de):de=e[48];let Ce;e[49]!==M||e[50]!==$?(Ce=$&&M&&p.jsx(iu,{skeleton:M}),e[49]=M,e[50]=$,e[51]=Ce):Ce=e[51];let _e;e[52]!==le||e[53]!==Se||e[54]!==Fe||e[55]!==re||e[56]!==se||e[57]!==we||e[58]!==de||e[59]!==Ce||e[60]!==c?(_e=p.jsxs(Ru,{"data-fading-out":Se,"data-overlays":Fe,ref:N,$zIndex:c,children:[re,se,we,le,de,Ce]}),e[52]=le,e[53]=Se,e[54]=Fe,e[55]=re,e[56]=se,e[57]=we,e[58]=de,e[59]=Ce,e[60]=c,e[61]=_e):_e=e[61];let Pe;e[62]!==n||e[63]!==_e?(Pe=p.jsx(bu,{comlink:n,children:_e}),e[62]=n,e[63]=_e,e[64]=Pe):Pe=e[64];let $e;e[65]!==n||e[66]!==Pe?($e=p.jsx(pu,{comlink:n,children:Pe}),e[65]=n,e[66]=Pe,e[67]=$e):$e=e[67];let Re;e[68]!==n||e[69]!==S||e[70]!==$e?(Re=p.jsx(gu,{comlink:n,elements:S,children:$e}),e[68]=n,e[69]=S,e[70]=$e,e[71]=Re):Re=e[71];let Ae;e[72]!==C||e[73]!==Re?(Ae=p.jsx(Lo,{children:p.jsx(Uo,{element:C,children:Re})}),e[72]=C,e[73]=Re,e[74]=Ae):Ae=e[74];let Te;e[75]!==ze||e[76]!==Ae?(Te=p.jsx(zo,{scheme:ze,theme:Fo,tone:"transparent",children:Ae}),e[75]=ze,e[76]=Ae,e[77]=Te):Te=e[77];let tt;return e[78]!==n||e[79]!==Te?(tt=p.jsx(Iu,{comlink:n,children:Te}),e[78]=n,e[79]=Te,e[80]=tt):tt=e[80],tt}function Ou(t){return t.activated||t.focused}function Nu(t){return"id"in t.sanity?[t.sanity.id]:[]}function Lu(t){return!t}function Uu(t){return!t}function zu(t){return!t}function Fu(t){return!t}function Gu(t){const e=t.target;if((Go(e)||qo(e)&&e.closest("a"))&&t.altKey){t.preventDefault(),t.stopPropagation();const n=new MouseEvent(t.type,{...t,altKey:!1,bubbles:!0,cancelable:!0});t.target?.dispatchEvent(n)}}function qu(t){return t()}function Ku(t){return!t}const Vu=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),Nn={alt:"altKey",ctrl:"ctrlKey",mod:Vu?"metaKey":"ctrlKey",shift:"shiftKey"};function Wu(t,e){return t.every(n=>Nn[n]?e[Nn[n]]:e.key===n.toUpperCase())}function Ln(t){return t.key==="Alt"}function Bu(t,e){return t.filter(n=>n!==e)}const Hu=t=>{const e=q.c(4),{comlink:n,refresh:r}=t,o=g.useRef(0),i=g.useRef(0);let s,c;return e[0]!==n||e[1]!==r?(s=()=>n.on("presentation/refresh",a=>{if(a.source==="manual"){clearTimeout(o.current);const u=r(a);if(u===!1)return;n.post("visual-editing/refreshing",a);let l=!1;o.current=window.setTimeout(()=>{n.post("visual-editing/refreshed",a),l=!0},3e3),u?.finally?.(()=>{l||(clearTimeout(o.current),n.post("visual-editing/refreshed",a))})}else if(a.source==="mutation"){clearTimeout(i.current);const u=r(a);if(u===!1)return;n.post("visual-editing/refreshing",a),i.current=window.setTimeout(()=>{const l=r(a);l!==!1&&(n.post("visual-editing/refreshing",a),l?.finally?.(()=>{n.post("visual-editing/refreshed",a)})||n.post("visual-editing/refreshed",a))},1e3),u?.finally?.(()=>{n.post("visual-editing/refreshed",a)})||n.post("visual-editing/refreshed",a)}}),c=[n,r],e[0]=n,e[1]=r,e[2]=s,e[3]=c):(s=e[2],c=e[3]),g.useEffect(s,c),null};function Yu(t){const e=q.c(9),n=t===void 0?!0:t,[r,o]=g.useState(),[i,s]=g.useState("idle");let c,a;e[0]!==n?(c=()=>{if(!n)return;const d=Io({name:"visual-editing",connectTo:"presentation"},So().provide({actors:ni()})),y=d.onStatus(()=>s("connected"),"connected");g.startTransition(()=>o(d));const v=d.start();return()=>{y(),v(),g.startTransition(()=>o(void 0))}},a=[n],e[0]=n,e[1]=c,e[2]=a):(c=e[1],a=e[2]),g.useEffect(c,a);let u,l;e[3]!==i?(u=()=>{if(i==="connected")return;const d=new AbortController;return window.addEventListener("message",Xu,{signal:d.signal}),()=>{d.abort()}},l=[i],e[3]=i,e[4]=u,e[5]=l):(u=e[4],l=e[5]),g.useEffect(u,l);let f;return e[6]!==r||e[7]!==i?(f=[r,i],e[6]=r,e[7]=i,e[8]=f):f=e[8],f}function Xu(t){const{data:e,origin:n}=t;e&&typeof e=="object"&&"domain"in e&&e.domain==="sanity/channels"&&"from"in e&&e.from==="presentation"&&"type"in e&&e.type==="presentation/status"&&window.parent.postMessage({domain:"sanity/channels",type:"visual-editing/status",data:{origin:location.origin}},n)}function Ju(t){const e=new Ro(1),n=new Ao;return t.fetch("visual-editing/snapshot-welcome",void 0,{suppressWarnings:!0}).then(r=>{e.next(r.event)}).catch(()=>{}),t.on("presentation/snapshot-event",r=>{r.event.type==="reconnect"&&e.next(r.event),r.event.type==="mutation"&&n.next(r.event)}),Ot(e,n)}function Zu(t){const e=q.c(3);let n,r;e[0]!==t?(n=()=>{if(!t)return;const o=Ju(t),i=gc(t),s=ko(i,{input:{client:{withConfig:el},sharedListener:o}});s.start();const c=new AbortController;return t.fetch("visual-editing/features",void 0,{signal:c.signal,suppressWarnings:!0}).then(a=>{a.features.optimistic&&zi(s)}).catch(Qu),()=>{s.stop(),c.abort()}},r=[t],e[0]=t,e[1]=n,e[2]=r):(n=e[1],r=e[2]),g.useEffect(n,r)}function Qu(){console.warn("[@sanity/visual-editing] Package version mismatch detected: Please update your Sanity studio to prevent potential compatibility issues.")}function el(){}const Kr=t=>{const e=q.c(29),{components:n,plugins:r,history:o,portal:i,refresh:s,zIndex:c,onPerspectiveChange:a}=t,u=i===void 0?!0:i,[l,f]=g.useState(null),[d,y]=g.useState(null);let v,m;e[0]===Symbol.for("react.memo_cache_sentinel")?(v=()=>{g.startTransition(()=>{f(Bn()),y(Hn())})},m=[],e[0]=v,e[1]=m):(v=e[0],m=e[1]),g.useEffect(v,m);const[E,M]=g.useState(null);let S,$;e[2]!==u?(S=()=>{if(u===!1)return;const I=document.createElement("sanity-visual-editing");return document.documentElement.appendChild(I),g.startTransition(()=>M(I)),()=>{g.startTransition(()=>M(null)),document.documentElement.contains(I)&&document.documentElement.removeChild(I)}},$=[u],e[2]=u,e[3]=S,e[4]=$):(S=e[3],$=e[4]),g.useEffect(S,$);const[k,R]=Yu(l===!0||d===!0);Zu(R==="connected"?k:void 0);let A,U;e[5]!==R||e[6]!==l||e[7]!==d?(A=()=>{if(R==="connected")He(d?"presentation-window":"presentation-iframe");else if(l||d){const I=setTimeout(tl,1e3);return()=>{clearTimeout(I),He(null)}}else He("standalone");return nl},U=[R,d,l],e[5]=R,e[6]=l,e[7]=d,e[8]=A,e[9]=U):(A=e[8],U=e[9]),g.useEffect(A,U);let C;e[10]!==k||e[11]!==R||e[12]!==n||e[13]!==l||e[14]!==d||e[15]!==a||e[16]!==r||e[17]!==c?(C=l!==null&&d!==null&&p.jsx(Du,{comlink:k,comlinkStatus:R,componentResolver:n,onPerspectiveChange:a,plugins:r,inFrame:l,inPopUp:d,zIndex:c}),e[10]=k,e[11]=R,e[12]=n,e[13]=l,e[14]=d,e[15]=a,e[16]=r,e[17]=c,e[18]=C):C=e[18];let N;e[19]!==k||e[20]!==o||e[21]!==s?(N=k&&p.jsxs(p.Fragment,{children:[p.jsx(wc,{comlink:k,history:o}),p.jsx(bc,{comlink:k}),s&&p.jsx(Hu,{comlink:k,refresh:s})]}),e[19]=k,e[20]=o,e[21]=s,e[22]=N):N=e[22];let _;e[23]!==C||e[24]!==N?(_=p.jsxs(p.Fragment,{children:[C,N]}),e[23]=C,e[24]=N,e[25]=_):_=e[25];const j=_;if(u===!1||!E)return j;let P;return e[26]!==j||e[27]!==E?(P=Eo.createPortal(j,E),e[26]=j,e[27]=E,e[28]=P):P=e[28],P};Kr.displayName="VisualEditing";function tl(){return He("standalone")}function nl(){return He(null)}let xe=null,De=null,At=null;function cl(t,{components:e,history:n,refresh:r,zIndex:o,plugins:i,onPerspectiveChange:s}){At&&clearTimeout(At),t.addEventListener("abort",()=>{At=setTimeout(()=>{De&&(De.unmount(),De=null),xe&&(xe.parentNode.removeChild(xe),xe=null)},1e3)}),xe||(xe=document.createElement("sanity-visual-editing"),document.body.parentNode.insertBefore(xe,document.body.nextSibling)),De||(De=ti.createRoot(xe)),De.render(p.jsx(g.StrictMode,{children:p.jsx(Kr,{components:e,plugins:i,history:n,refresh:r,zIndex:o,onPerspectiveChange:s,portal:!1})}))}export{cl as renderVisualEditing};
