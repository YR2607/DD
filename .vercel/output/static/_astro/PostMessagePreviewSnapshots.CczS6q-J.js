import{c as y}from"./compiler-runtime.BVN8GnAY.js";import{r as o}from"./index.DB4Po_jQ.js";import{a6 as $,Y as M,aS as U,b7 as j,b8 as D,aZ as F}from"./studio-component.CBxzOH7u.js";import{o as I,c as O,a as z,a2 as L,a6 as N,a0 as R,a7 as T,at as V,t as W,z as Y}from"./index.GAdVpEDN.js";import"./client.C73kiKoU.js";function Z(s){return I(function(e,t){var r=!1,n=0;e.subscribe(O(t,function(a){return(r||(r=!s(a,n++)))&&t.next(a)}))})}const q=s=>{const e=y.c(16),{comlink:t,refs:r,perspective:n}=s,a=$(),p=M();let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=new z,e[0]=c):c=e[0];const g=c;let u;e[1]!==a||e[2]!==n||e[3]!==p?(u=g.asObservable().pipe(U(w=>D(w.map(i=>{const P={...i,_id:L(i._id)},E=n==="published"?F:a.observeForPreview(P,p.get(P._type)).pipe(N(),Z(A)),x={...i,_id:R(i._id)},k=a.observeForPreview(x,p.get(x._type));return T(k.pipe(V(E)),E).pipe(W(B),Y(C))}))),j(0)),e[1]=a,e[2]=n,e[3]=p,e[4]=u):u=e[4];const m=u;let l;e[5]===Symbol.for("react.memo_cache_sentinel")?(l=[],e[5]=l):l=e[5];const S=o.useRef(l);let f,b;e[6]!==t||e[7]!==m?(f=()=>{const w=m.subscribe(i=>{t.post("presentation/preview-snapshots",{snapshots:i}),S.current=i});return()=>{w.unsubscribe()}},b=[t,m],e[6]=t,e[7]=m,e[8]=f,e[9]=b):(f=e[8],b=e[9]),o.useEffect(f,b);let d,h;e[10]!==t?(d=()=>t.on("visual-editing/preview-snapshots",()=>({snapshots:S.current})),h=[t],e[10]=t,e[11]=d,e[12]=h):(d=e[11],h=e[12]),o.useEffect(d,h);let v,_;return e[13]!==r?(v=()=>{g.next(r)},_=[r,g],e[13]=r,e[14]=v,e[15]=_):(v=e[14],_=e[15]),o.useEffect(v,_),null};var X=o.memo(q);function A(s){return s.snapshot===null}function B(s){return!!s.snapshot}function C(s){const e=s.snapshot;return{_id:R(e._id),title:e.title,subtitle:e.subtitle,description:e.description,imageUrl:e.imageUrl}}export{X as default};
